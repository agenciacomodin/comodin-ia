(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3545],{32482:function(e,s,a){Promise.resolve().then(a.bind(a,82538)),Promise.resolve().then(a.bind(a,34267)),Promise.resolve().then(a.t.bind(a,65558,23))},82538:function(e,s,a){"use strict";a.d(s,{ProtectedRoute:function(){return d}});var t=a(15444),n=a(51924),r=a(56948),i=a(81059),o=a(70362),c=a(2422),l=a(79047);function d({children:e,permissions:s=[],requireAll:a=!1,fallback:d,redirectTo:u}){let{isLoading:m,isAuthenticated:x,hasAnyPermission:f,hasAllPermissions:p,getDashboardRoute:h}=(0,n.TE)(),g=(0,l.useRouter)();return m?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):x?!(s.length>0)||(a?p(s):f(s))?(0,t.jsx)(t.Fragment,{children:e}):d?(0,t.jsx)(t.Fragment,{children:d}):(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,t.jsxs)(r.bZ,{className:"max-w-md",children:[(0,t.jsx)(o.Z,{className:"h-4 w-4"}),(0,t.jsx)(r.Cd,{children:"Sin Permisos"}),(0,t.jsx)(r.X,{children:"No tienes los permisos necesarios para acceder a esta funcionalidad."}),(0,t.jsx)(c.z,{onClick:()=>g.push(u||h()),className:"mt-3 w-full",children:"Volver al Dashboard"})]})}):(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,t.jsxs)(r.bZ,{className:"max-w-md",children:[(0,t.jsx)(i.Z,{className:"h-4 w-4"}),(0,t.jsx)(r.Cd,{children:"Acceso Denegado"}),(0,t.jsx)(r.X,{children:"Debes iniciar sesi\xf3n para acceder a esta p\xe1gina."}),(0,t.jsx)(c.z,{onClick:()=>g.push("/auth/login"),className:"mt-3 w-full",children:"Iniciar Sesi\xf3n"})]})})}},34267:function(e,s,a){"use strict";a.d(s,{IntegrationsManager:function(){return O}});var t=a(15444),n=a(89300),r=a(99827),i=a(2422),o=a(61335),c=a(86765),l=a(74678),d=a(54907),u=a(64624),m=a(26378),x=a(19130),f=a(66124),p=a(77694),h=a(62492),g=a(70362),N=a(6488),E=a(25076),j=a(40563),v=a(39429),b=a(33394),y=a(99983),I=a(65522),C=a(33186),R=a(29530),A=a(34635),T=a(46167),S=a(56948),w=a(1946),D=a(64611);function P({integration:e,open:s,onOpenChange:a,onSuccess:r}){let[o,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)("form"),[m,x]=(0,n.useState)({}),[p,h]=(0,n.useState)([]),[N,E]=(0,n.useState)(null),j=e.platform&&e.platform in C.Ug?C.Ug[e.platform]:null,v=(e,s)=>{x(a=>({...a,[e]:s}))},y=(e,s)=>{h(a=>s?[...a,e]:a.filter(s=>s!==e))},I=async()=>{c(!0),u("testing");try{let s=await fetch("/api/integrations/test-connection",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({integrationId:e.id,credentials:m,features:p})}),a=await s.json();if(E(a),s.ok&&a.success)await P();else throw Error(a.error||"Error al probar la conexi\xf3n")}catch(e){console.error("Error testing connection:",e),D.Am.error("Error al probar la conexi\xf3n"),u("form")}finally{c(!1)}},P=async()=>{try{if((await fetch("/api/integrations/connections",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({integrationId:e.id,name:m.name||e.displayName,credentials:m,features:p,config:{...m,testResults:N}})})).ok)u("success"),D.Am.success("Integraci\xf3n conectada exitosamente"),setTimeout(()=>{r()},2e3);else throw Error("Error al crear la conexi\xf3n")}catch(e){console.error("Error creating connection:",e),D.Am.error("Error al crear la conexi\xf3n"),u("form")}};return(0,t.jsx)(R.Vq,{open:s,onOpenChange:a,children:(0,t.jsxs)(R.cZ,{className:"sm:max-w-[500px]",children:[(0,t.jsxs)(R.fK,{children:[(0,t.jsxs)(R.$N,{className:"flex items-center space-x-2",children:[(0,t.jsxs)("span",{children:["Conectar ",e.displayName]}),j?.documentation&&(0,t.jsx)(i.z,{variant:"ghost",size:"sm",asChild:!0,children:(0,t.jsx)("a",{href:j.documentation,target:"_blank",rel:"noopener noreferrer",children:(0,t.jsx)(b.Z,{className:"w-4 h-4"})})})]}),(0,t.jsx)(R.Be,{children:j?.description||e.description})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)(S.bZ,{children:[(0,t.jsx)(g.Z,{className:"h-4 w-4"}),(0,t.jsx)(S.X,{children:"Las credenciales se almacenan de forma segura y encriptada. Solo se utilizan para consultas autorizadas a tu tienda."})]}),"form"===d&&(j?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(A.Label,{htmlFor:"name",children:"Nombre de la conexi\xf3n (opcional)"}),(0,t.jsx)(l.I,{id:"name",placeholder:`Mi tienda ${e.displayName}`,value:m.name||"",onChange:e=>v("name",e.target.value)})]}),"SHOPIFY"===e.platform&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(A.Label,{htmlFor:"shop_domain",children:"Dominio de la tienda *"}),(0,t.jsx)(l.I,{id:"shop_domain",placeholder:"mi-tienda.myshopify.com",value:m.shop_domain||"",onChange:e=>v("shop_domain",e.target.value),required:!0}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Solo el dominio, ejemplo: mi-tienda.myshopify.com"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(A.Label,{htmlFor:"access_token",children:"Token de acceso *"}),(0,t.jsx)(l.I,{id:"access_token",type:"password",placeholder:"shpat_...",value:m.access_token||"",onChange:e=>v("access_token",e.target.value),required:!0}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Token de acceso privado de tu aplicaci\xf3n Shopify"})]})]}),"WOOCOMMERCE"===e.platform&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(A.Label,{htmlFor:"site_url",children:"URL del sitio *"}),(0,t.jsx)(l.I,{id:"site_url",placeholder:"https://mi-tienda.com",value:m.site_url||"",onChange:e=>v("site_url",e.target.value),required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(A.Label,{htmlFor:"consumer_key",children:"Consumer Key *"}),(0,t.jsx)(l.I,{id:"consumer_key",placeholder:"ck_...",value:m.consumer_key||"",onChange:e=>v("consumer_key",e.target.value),required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(A.Label,{htmlFor:"consumer_secret",children:"Consumer Secret *"}),(0,t.jsx)(l.I,{id:"consumer_secret",type:"password",placeholder:"cs_...",value:m.consumer_secret||"",onChange:e=>v("consumer_secret",e.target.value),required:!0})]})]}),"TIENDANUBE"===e.platform&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(A.Label,{htmlFor:"store_id",children:"ID de la tienda *"}),(0,t.jsx)(l.I,{id:"store_id",placeholder:"123456",value:m.store_id||"",onChange:e=>v("store_id",e.target.value),required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(A.Label,{htmlFor:"access_token",children:"Token de acceso *"}),(0,t.jsx)(l.I,{id:"access_token",type:"password",placeholder:"abc123...",value:m.access_token||"",onChange:e=>v("access_token",e.target.value),required:!0})]})]}),j.supportedFeatures&&j.supportedFeatures.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)(A.Label,{children:"Funcionalidades a habilitar"}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2 mt-2",children:j.supportedFeatures.map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(T.X,{id:e,checked:p.includes(e),onCheckedChange:s=>y(e,s)}),(0,t.jsx)(A.Label,{htmlFor:e,className:"text-sm capitalize",children:e})]},e))})]})]}):null),"testing"===d&&(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(w.Z,{className:"mx-auto h-8 w-8 animate-spin text-blue-600 mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Probando conexi\xf3n..."}),(0,t.jsx)("p",{className:"text-gray-500",children:"Verificando credenciales y configuraci\xf3n"})]}),"success"===d&&(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(f.Z,{className:"mx-auto h-12 w-12 text-green-600 mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"\xa1Conexi\xf3n exitosa!"}),(0,t.jsxs)("p",{className:"text-gray-500 mb-4",children:[e.displayName," se ha conectado correctamente"]}),N?.storeInfo&&(0,t.jsxs)("div",{className:"bg-green-50 rounded-lg p-4 mt-4 text-left",children:[(0,t.jsx)("h4",{className:"font-medium text-green-900 mb-2",children:"Informaci\xf3n de la tienda:"}),(0,t.jsxs)("div",{className:"text-sm text-green-800 space-y-1",children:[N.storeInfo.name&&(0,t.jsxs)("p",{children:["Nombre: ",N.storeInfo.name]}),N.storeInfo.url&&(0,t.jsxs)("p",{children:["URL: ",N.storeInfo.url]}),N.storeInfo.productsCount&&(0,t.jsxs)("p",{children:["Productos: ",N.storeInfo.productsCount]})]})]})]}),"form"===d&&(0,t.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,t.jsx)(i.z,{variant:"outline",onClick:()=>a(!1),children:"Cancelar"}),(0,t.jsxs)(i.z,{onClick:I,disabled:o,children:[o&&(0,t.jsx)(w.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Probar y Conectar"]})]})]})]})})}function O({organizationId:e}){let[s,a]=(0,n.useState)([]),[R,A]=(0,n.useState)([]),[T,S]=(0,n.useState)(null),[w,O]=(0,n.useState)(!0),[_,L]=(0,n.useState)(""),[M,k]=(0,n.useState)("all"),[U,F]=(0,n.useState)(!1),[Z,V]=(0,n.useState)(null);(0,n.useEffect)(()=>{G(),z(),B()},[e]);let G=async()=>{try{let e=await fetch("/api/integrations");if(e.ok){let s=await e.json();a(s.integrations||[])}}catch(e){console.error("Error loading integrations:",e),D.Am.error("Error al cargar integraciones")}},z=async()=>{try{let e=await fetch("/api/integrations/connections");if(e.ok){let s=await e.json();A(s.connections||[])}}catch(e){console.error("Error loading connections:",e),D.Am.error("Error al cargar conexiones")}},B=async()=>{try{let e=await fetch("/api/integrations/stats");if(e.ok){let s=await e.json();S(s.stats)}}catch(e){console.error("Error loading stats:",e)}finally{O(!1)}},H=s.filter(e=>{let s=e.displayName.toLowerCase().includes(_.toLowerCase())||e.description?.toLowerCase().includes(_.toLowerCase()),a="all"===M||e.type===M;return s&&a}),Y=e=>{let s=R.find(s=>s.integrationId===e);return s?.status||"AVAILABLE"},W=e=>{let s=R.find(s=>s.integrationId===e);return s?.id},q=e=>{V(e),F(!0)},X=async(e,s)=>{if(confirm("\xbfEst\xe1s seguro de que deseas desconectar esta integraci\xf3n?"))try{if((await fetch(`/api/integrations/connections/${s}`,{method:"DELETE"})).ok)await z(),await B(),D.Am.success("Integraci\xf3n desconectada exitosamente");else throw Error("Error al desconectar")}catch(e){console.error("Error disconnecting:",e),D.Am.error("Error al desconectar la integraci\xf3n")}},K=e=>{switch(e){case"ECOMMERCE":return(0,t.jsx)(d.Z,{className:"w-5 h-5"});case"CRM":return(0,t.jsx)(u.Z,{className:"w-5 h-5"});case"ANALYTICS":return(0,t.jsx)(m.Z,{className:"w-5 h-5"});default:return(0,t.jsx)(x.Z,{className:"w-5 h-5"})}},Q=e=>{switch(e){case"CONNECTED":return(0,t.jsx)(f.Z,{className:"w-4 h-4 text-green-500"});case"ERROR":return(0,t.jsx)(p.Z,{className:"w-4 h-4 text-red-500"});case"PENDING":return(0,t.jsx)(h.Z,{className:"w-4 h-4 text-blue-500"});case"DISCONNECTED":return(0,t.jsx)(g.Z,{className:"w-4 h-4 text-yellow-500"});default:return(0,t.jsx)(N.Z,{className:"w-4 h-4 text-gray-400"})}};return w?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,t.jsxs)("div",{className:"space-y-6",children:[T&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsx)(r.Zb,{children:(0,t.jsx)(r.aY,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Disponibles"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:T.total})]}),(0,t.jsx)(x.Z,{className:"h-8 w-8 text-blue-500"})]})})}),(0,t.jsx)(r.Zb,{children:(0,t.jsx)(r.aY,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Conectadas"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-green-600",children:T.connected})]}),(0,t.jsx)(f.Z,{className:"h-8 w-8 text-green-500"})]})})}),(0,t.jsx)(r.Zb,{children:(0,t.jsx)(r.aY,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Con Errores"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-red-600",children:T.error})]}),(0,t.jsx)(p.Z,{className:"h-8 w-8 text-red-500"})]})})}),(0,t.jsx)(r.Zb,{children:(0,t.jsx)(r.aY,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"E-commerce"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:T.byType.ECOMMERCE||0})]}),(0,t.jsx)(d.Z,{className:"h-8 w-8 text-orange-500"})]})})})]}),(0,t.jsxs)(c.Tabs,{defaultValue:"available",className:"space-y-6",children:[(0,t.jsxs)(c.TabsList,{className:"grid w-full grid-cols-3",children:[(0,t.jsx)(c.TabsTrigger,{value:"available",children:"Disponibles"}),(0,t.jsx)(c.TabsTrigger,{value:"connected",children:"Conectadas"}),(0,t.jsx)(c.TabsTrigger,{value:"activity",children:"Actividad"})]}),(0,t.jsxs)(c.TabsContent,{value:"available",className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)(E.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,t.jsx)(l.I,{placeholder:"Buscar integraciones...",value:_,onChange:e=>L(e.target.value),className:"pl-10"})]}),(0,t.jsxs)("select",{value:M,onChange:e=>k(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"all",children:"Todos los tipos"}),(0,t.jsx)("option",{value:"ECOMMERCE",children:"E-commerce"}),(0,t.jsx)("option",{value:"CRM",children:"CRM"}),(0,t.jsx)("option",{value:"ERP",children:"ERP"}),(0,t.jsx)("option",{value:"ANALYTICS",children:"An\xe1lisis"}),(0,t.jsx)("option",{value:"MARKETING",children:"Marketing"})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:H.map(e=>{let s=Y(e.id),a=W(e.id),n="CONNECTED"===s;return(0,t.jsxs)(r.Zb,{className:"relative overflow-hidden",children:[(0,t.jsx)(r.Ol,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:(0,I.cn)("w-12 h-12 rounded-lg flex items-center justify-center",e.brandColor?`bg-[${e.brandColor}]`:"bg-gray-100"),children:K(e.type)}),(0,t.jsxs)("div",{children:[(0,t.jsx)(r.ll,{className:"text-lg",children:e.displayName}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:C.ym[e.type]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[Q(s),(0,t.jsx)(o.C,{variant:"secondary",className:(0,I.cn)("text-xs","CONNECTED"===s&&"bg-green-100 text-green-800","ERROR"===s&&"bg-red-100 text-red-800","PENDING"===s&&"bg-blue-100 text-blue-800"),children:C.Pg[s]})]})]})}),(0,t.jsxs)(r.aY,{className:"pb-4",children:[(0,t.jsx)(r.SZ,{className:"mb-4",children:e.description}),(0,t.jsxs)("div",{className:"space-y-3",children:[e.supportedFeatures&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Funcionalidades:"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:e.supportedFeatures.map(e=>(0,t.jsx)(o.C,{variant:"outline",className:"text-xs",children:e},e))})]}),(0,t.jsxs)("div",{className:"flex gap-2 pt-2",children:[n?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.z,{variant:"outline",size:"sm",className:"flex-1",children:[(0,t.jsx)(N.Z,{className:"w-4 h-4 mr-2"}),"Configurar"]}),(0,t.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>a&&X(e.id,a),children:(0,t.jsx)(j.Z,{className:"w-4 h-4"})})]}):(0,t.jsxs)(i.z,{onClick:()=>q(e),size:"sm",className:"flex-1",children:[(0,t.jsx)(v.Z,{className:"w-4 h-4 mr-2"}),"Conectar"]}),e.documentation&&(0,t.jsx)(i.z,{variant:"ghost",size:"sm",asChild:!0,children:(0,t.jsx)("a",{href:e.documentation,target:"_blank",rel:"noopener noreferrer",children:(0,t.jsx)(b.Z,{className:"w-4 h-4"})})})]})]})]})]},e.id)})}),0===H.length&&(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(x.Z,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron integraciones"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Intenta ajustar los filtros de b\xfasqueda"})]})]}),(0,t.jsx)(c.TabsContent,{value:"connected",className:"space-y-6",children:R.length>0?(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:R.map(e=>(0,t.jsxs)(r.Zb,{children:[(0,t.jsx)(r.Ol,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:K(e.integration.type)}),(0,t.jsxs)("div",{children:[(0,t.jsx)(r.ll,{className:"text-lg",children:e.name||e.integration.displayName}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:e.storeName||e.integration.description})]})]}),Q(e.status)]})}),(0,t.jsx)(r.aY,{children:(0,t.jsxs)("div",{className:"space-y-3",children:[e.storeUrl&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"URL de la tienda:"}),(0,t.jsx)("p",{className:"text-sm text-blue-600",children:e.storeUrl})]}),e.lastSyncAt&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"\xdaltima sincronizaci\xf3n:"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:new Date(e.lastSyncAt).toLocaleString("es-ES")})]}),(0,t.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,t.jsxs)(i.z,{variant:"outline",size:"sm",className:"flex-1",children:[(0,t.jsx)(N.Z,{className:"w-4 h-4 mr-2"}),"Configurar"]}),(0,t.jsxs)(i.z,{variant:"outline",size:"sm",children:[(0,t.jsx)(y.Z,{className:"w-4 h-4 mr-2"}),"Sincronizar"]}),(0,t.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>X(e.integrationId,e.id),children:(0,t.jsx)(j.Z,{className:"w-4 h-4"})})]})]})})]},e.id))}):(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(f.Z,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay integraciones conectadas"}),(0,t.jsx)("p",{className:"text-gray-500",children:'Conecta tu primera integraci\xf3n desde la pesta\xf1a "Disponibles"'})]})}),(0,t.jsx)(c.TabsContent,{value:"activity",className:"space-y-6",children:(0,t.jsxs)(r.Zb,{children:[(0,t.jsxs)(r.Ol,{children:[(0,t.jsx)(r.ll,{children:"Actividad Reciente"}),(0,t.jsx)(r.SZ,{children:"Historial de eventos de sincronizaci\xf3n y conexiones"})]}),(0,t.jsx)(r.aY,{children:(0,t.jsx)("div",{className:"space-y-4",children:T?.recentActivity&&T.recentActivity.length>0?T.recentActivity.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between py-2 border-b last:border-b-0",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(y.Z,{className:"w-4 h-4 text-blue-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:e.action}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.integrationName})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)(o.C,{variant:"success"===e.status?"default":"destructive",className:"text-xs mb-1",children:e.status}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:new Date(e.timestamp).toLocaleString("es-ES")})]})]},e.id)):(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(y.Z,{className:"mx-auto h-8 w-8 text-gray-400 mb-2"}),(0,t.jsx)("p",{className:"text-gray-500",children:"No hay actividad reciente"})]})})})]})})]}),Z&&(0,t.jsx)(P,{integration:Z,open:U,onOpenChange:F,onSuccess:()=>{z(),B(),F(!1),V(null)}})]})}},56948:function(e,s,a){"use strict";a.d(s,{Cd:function(){return l},X:function(){return d},bZ:function(){return c}});var t=a(15444),n=a(89300),r=a(2371),i=a(65522);let o=(0,r.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),c=n.forwardRef(({className:e,variant:s,...a},n)=>(0,t.jsx)("div",{ref:n,role:"alert",className:(0,i.cn)(o({variant:s}),e),...a}));c.displayName="Alert";let l=n.forwardRef(({className:e,...s},a)=>(0,t.jsx)("h5",{ref:a,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",e),...s}));l.displayName="AlertTitle";let d=n.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",e),...s}));d.displayName="AlertDescription"},61335:function(e,s,a){"use strict";a.d(s,{C:function(){return o}});var t=a(15444);a(89300);var n=a(2371),r=a(65522);let i=(0,n.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o({className:e,variant:s,...a}){return(0,t.jsx)("div",{className:(0,r.cn)(i({variant:s}),e),...a})}},99827:function(e,s,a){"use strict";a.d(s,{Ol:function(){return o},SZ:function(){return l},Zb:function(){return i},aY:function(){return d},eW:function(){return u},ll:function(){return c}});var t=a(15444),n=a(89300),r=a(65522);let i=n.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...s}));i.displayName="Card";let o=n.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",e),...s}));o.displayName="CardHeader";let c=n.forwardRef(({className:e,...s},a)=>(0,t.jsx)("h3",{ref:a,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",e),...s}));c.displayName="CardTitle";let l=n.forwardRef(({className:e,...s},a)=>(0,t.jsx)("p",{ref:a,className:(0,r.cn)("text-sm text-muted-foreground",e),...s}));l.displayName="CardDescription";let d=n.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,r.cn)("p-6 pt-0",e),...s}));d.displayName="CardContent";let u=n.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,r.cn)("flex items-center p-6 pt-0",e),...s}));u.displayName="CardFooter"},46167:function(e,s,a){"use strict";a.d(s,{X:function(){return c}});var t=a(15444),n=a(89300),r=a(91831),i=a(77248),o=a(65522);let c=n.forwardRef(({className:e,...s},a)=>(0,t.jsx)(r.fC,{ref:a,className:(0,o.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...s,children:(0,t.jsx)(r.z$,{className:(0,o.cn)("flex items-center justify-center text-current"),children:(0,t.jsx)(i.Z,{className:"h-4 w-4"})})}));c.displayName=r.fC.displayName},29530:function(e,s,a){"use strict";a.d(s,{$N:function(){return p},Be:function(){return h},Vq:function(){return c},cN:function(){return f},cZ:function(){return m},fK:function(){return x},hg:function(){return l}});var t=a(15444),n=a(89300),r=a(49095),i=a(33485),o=a(65522);let c=r.fC,l=r.xz,d=r.h_;r.x8;let u=n.forwardRef(({className:e,...s},a)=>(0,t.jsx)(r.aV,{ref:a,className:(0,o.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s}));u.displayName=r.aV.displayName;let m=n.forwardRef(({className:e,children:s,...a},n)=>(0,t.jsxs)(d,{children:[(0,t.jsx)(u,{}),(0,t.jsxs)(r.VY,{ref:n,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...a,children:[s,(0,t.jsxs)(r.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,t.jsx)(i.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));m.displayName=r.VY.displayName;let x=({className:e,...s})=>(0,t.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...s});x.displayName="DialogHeader";let f=({className:e,...s})=>(0,t.jsx)("div",{className:(0,o.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...s});f.displayName="DialogFooter";let p=n.forwardRef(({className:e,...s},a)=>(0,t.jsx)(r.Dx,{ref:a,className:(0,o.cn)("text-lg font-semibold leading-none tracking-tight",e),...s}));p.displayName=r.Dx.displayName;let h=n.forwardRef(({className:e,...s},a)=>(0,t.jsx)(r.dk,{ref:a,className:(0,o.cn)("text-sm text-muted-foreground",e),...s}));h.displayName=r.dk.displayName},74678:function(e,s,a){"use strict";a.d(s,{I:function(){return i}});var t=a(15444),n=a(89300),r=a(65522);let i=n.forwardRef(({className:e,type:s,...a},n)=>(0,t.jsx)("input",{type:s,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...a}));i.displayName="Input"},34635:function(e,s,a){"use strict";a.d(s,{Label:function(){return l}});var t=a(15444),n=a(89300),r=a(4100),i=a(2371),o=a(65522);let c=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),l=n.forwardRef(({className:e,...s},a)=>(0,t.jsx)(r.f,{ref:a,className:(0,o.cn)(c(),e),...s}));l.displayName=r.f.displayName},86765:function(e,s,a){"use strict";a.d(s,{Tabs:function(){return o},TabsContent:function(){return d},TabsList:function(){return c},TabsTrigger:function(){return l}});var t=a(15444),n=a(89300),r=a(84018),i=a(65522);let o=r.fC,c=n.forwardRef(({className:e,...s},a)=>(0,t.jsx)(r.aV,{ref:a,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s}));c.displayName=r.aV.displayName;let l=n.forwardRef(({className:e,...s},a)=>(0,t.jsx)(r.xz,{ref:a,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...s}));l.displayName=r.xz.displayName;let d=n.forwardRef(({className:e,...s},a)=>(0,t.jsx)(r.VY,{ref:a,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));d.displayName=r.VY.displayName},51924:function(e,s,a){"use strict";a.d(s,{TE:function(){return r}});var t=a(75762),n=a(92937);function r(){let{data:e,status:s}=(0,t.useSession)(),a=e?.user,r=a?.role,i=a?.organizationId;return{isAuthenticated:!!e,isLoading:"loading"===s,user:a,role:r,organizationId:i,hasPermission:e=>!!r&&(0,n.N$)(r,e),hasAnyPermission:e=>!!r&&(0,n.vr)(r,e),hasAllPermissions:e=>{if(!r)return!1;let s=(0,n.ai)(r).map(e=>e.toString());return(0,n.wP)(s,e)},canAccessRoute:e=>{if(!r)return!1;let s=(0,n.ai)(r).map(e=>e.toString());return(0,n.mn)(s,e)},getDashboardRoute:()=>r?(0,n.Ol)(r):"/dashboard",getAllPermissions:()=>r?(0,n.ai)(r):[],isSuperAdmin:"SUPER_ADMIN"===r,isDistributor:"DISTRIBUIDOR"===r,isOwner:"PROPIETARIO"===r,isAgent:"AGENTE"===r,canManageUsers:"SUPER_ADMIN"===r||"PROPIETARIO"===r,canManageOrganization:"SUPER_ADMIN"===r||"PROPIETARIO"===r,canViewAllConversations:"AGENTE"!==r,canManageWhatsApp:"SUPER_ADMIN"===r||"PROPIETARIO"===r,canManageBilling:"SUPER_ADMIN"===r||"PROPIETARIO"===r,canConfigureAI:"SUPER_ADMIN"===r||"PROPIETARIO"===r,canViewReports:"AGENTE"!==r,canManageClients:"DISTRIBUIDOR"===r||"SUPER_ADMIN"===r}}},33186:function(e,s,a){"use strict";a.d(s,{BT:function(){return r.AutomationActionType},C2:function(){return S},DX:function(){return C},Dn:function(){return R},ED:function(){return f},Eb:function(){return N},FQ:function(){return E},Go:function(){return o},Jg:function(){return p},Om:function(){return u},Pg:function(){return b},Rh:function(){return T},Rn:function(){return g},Sn:function(){return l},UM:function(){return D},Ug:function(){return y},Vb:function(){return r.AutomationConditionType},WC:function(){return c},WV:function(){return I},WY:function(){return i},aE:function(){return m},d1:function(){return h},fB:function(){return d},hC:function(){return r.KnowledgeSourceStatus},hQ:function(){return j},mT:function(){return w},n9:function(){return x},rH:function(){return r.KnowledgeSourceType},uU:function(){return A},wu:function(){return P},ym:function(){return v}});var t,n,r=a(51181);(t=n||(n={})).INSUFFICIENT_BALANCE="INSUFFICIENT_BALANCE",t.NO_PROVIDER_AVAILABLE="NO_PROVIDER_AVAILABLE",t.PROVIDER_ERROR="PROVIDER_ERROR",t.INVALID_REQUEST="INVALID_REQUEST",t.RATE_LIMIT_EXCEEDED="RATE_LIMIT_EXCEEDED",t.INTERNAL_ERROR="INTERNAL_ERROR";let i={OPEN:"Abierta",PENDING:"Pendiente",RESOLVED:"Resuelta",TRANSFERRED:"Transferida",ARCHIVED:"Archivada"},o={LOW:"Baja",MEDIUM:"Media",HIGH:"Alta",URGENT:"Urgente"},c={LOW:"gray",MEDIUM:"blue",HIGH:"orange",URGENT:"red"},l={QR_CODE:"Conexi\xf3n R\xe1pida (QR)",API_OFFICIAL:"Conexi\xf3n Profesional (API)"},d={DISCONNECTED:"Desconectado",CONNECTING:"Conectando",CONNECTED:"Conectado",ERROR:"Error",EXPIRED:"Expirado"},u={DISCONNECTED:"gray",CONNECTING:"yellow",CONNECTED:"green",ERROR:"red",EXPIRED:"orange"},m={image:["image/jpeg","image/png","image/gif","image/webp"],document:["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain"],video:["video/mp4","video/avi","video/mov","video/wmv"],audio:["audio/mp3","audio/wav","audio/aac","audio/ogg"]},x={image:10485760,document:52428800,video:104857600,audio:20971520},f={SALES:"Ventas",SUPPORT:"Soporte",QUESTION:"Pregunta",COMPLAINT:"Queja",BOOKING:"Reserva",PAYMENT:"Pago",INFORMATION:"Informaci\xf3n",GREETING:"Saludo",FAREWELL:"Despedida",OTHER:"Otro"},p={SALES:"green",SUPPORT:"blue",QUESTION:"yellow",COMPLAINT:"red",BOOKING:"purple",PAYMENT:"orange",INFORMATION:"cyan",GREETING:"teal",FAREWELL:"gray",OTHER:"slate"},h={INTENTION_DETECTED:"Intenci\xf3n detectada",KEYWORDS_CONTAINS:"Contiene palabras clave",SENDER_IS_VIP:"Remitente es VIP",TIME_RANGE:"Horario espec\xedfico",FIRST_MESSAGE:"Primer mensaje",MESSAGE_COUNT:"N\xfamero de mensajes",RESPONSE_TIME:"Tiempo de respuesta"},g={ADD_TAG:"Agregar etiqueta",ASSIGN_AGENT:"Asignar agente",SET_PRIORITY:"Establecer prioridad",AUTO_REPLY:"Respuesta autom\xe1tica",MARK_VIP:"Marcar como VIP",TRANSFER_CONVERSATION:"Transferir conversaci\xf3n",CREATE_TASK:"Crear tarea",SEND_NOTIFICATION:"Enviar notificaci\xf3n"},N={pdf:["application/pdf"],document:["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],text:["text/plain","text/markdown","text/csv"],web:["text/html"]},E=52428800,j={UPLOADING:"Subiendo",PROCESSING:"Procesando",CHUNKING:"Fragmentando",EMBEDDING:"Generando Embeddings",ACTIVE:"Activo",ERROR:"Error",DISABLED:"Deshabilitado"},v={ECOMMERCE:"E-commerce",CRM:"CRM",ERP:"ERP",PAYMENT:"Pagos",ANALYTICS:"An\xe1lisis",MARKETING:"Marketing",SOCIAL_MEDIA:"Redes Sociales",EMAIL:"Email Marketing",SUPPORT:"Soporte",OTHER:"Otros"},b={AVAILABLE:"Disponible",CONNECTED:"Conectado",DISCONNECTED:"Desconectado",ERROR:"Error",PENDING:"Pendiente"},y={SHOPIFY:{displayName:"Shopify",description:"Conecta tu tienda Shopify para consultar productos, pedidos e inventario",authType:"oauth",authFields:["shop_domain","access_token"],iconUrl:"/integrations/shopify.svg",brandColor:"#7AB55C",supportedFeatures:["products","orders","customers","inventory"],documentation:"https://docs.shopify.com/api"},WOOCOMMERCE:{displayName:"WooCommerce",description:"Conecta tu tienda WooCommerce para gestionar productos y pedidos",authType:"api_key",authFields:["site_url","consumer_key","consumer_secret"],iconUrl:"/integrations/woocommerce.svg",brandColor:"#7F54B3",supportedFeatures:["products","orders","customers"],documentation:"https://woocommerce.github.io/woocommerce-rest-api-docs/"},TIENDANUBE:{displayName:"TiendaNube",description:"Conecta tu tienda TiendaNube para sincronizar cat\xe1logo y pedidos",authType:"oauth",authFields:["store_id","access_token"],iconUrl:"/integrations/tiendanube.svg",brandColor:"#FF6900",supportedFeatures:["products","orders","customers"],documentation:"https://developers.tiendanube.com/"}},I={PENDING:"Pendiente",APPROVED:"Aprobada",REJECTED:"Rechazada",PAUSED:"Pausada",ARCHIVED:"Archivada"},C={PENDING:"yellow",APPROVED:"green",REJECTED:"red",PAUSED:"orange",ARCHIVED:"gray"},R={DRAFT:"Borrador",SCHEDULED:"Programada",SENDING:"Enviando",COMPLETED:"Completada",PAUSED:"Pausada",CANCELLED:"Cancelada",FAILED:"Fallida"},A={DRAFT:"gray",SCHEDULED:"blue",SENDING:"yellow",COMPLETED:"green",PAUSED:"orange",CANCELLED:"red",FAILED:"red"},T={IMMEDIATE:"Inmediato",SCHEDULED:"Programado",DRIP:"Secuencial",AB_TEST:"Prueba A/B",WHATSAPP_BUSINESS:"WhatsApp Business",WHATSAPP_API:"WhatsApp API"},S={IMMEDIATE:"Env\xedo inmediato a todos los destinatarios",SCHEDULED:"Env\xedo programado para una fecha espec\xedfica",DRIP:"Env\xedo secuencial con intervalos definidos",AB_TEST:"Prueba diferentes versiones del mensaje",WHATSAPP_BUSINESS:"M\xe1ximo 40 mensajes diarios, cualquier contenido (texto/imagen/video/audio)",WHATSAPP_API:"Env\xedo ilimitado, solo plantillas verificadas por Meta"},w={INCLUDE_TAG:"Incluir etiqueta",EXCLUDE_TAG:"Excluir etiqueta",CHANNEL:"Canal de origen",VIP_STATUS:"Estado VIP",LAST_CONTACT:"\xdaltimo contacto",CONVERSATION_STATUS:"Estado de conversaci\xf3n"},D={SEND_RATE:10,BATCH_SIZE:100,RETRY_ATTEMPTS:3,PREVIEW_SAMPLE_SIZE:20,PREVIEW_EXPIRATION_HOURS:24},P={BUSINESS:{MAX_DAILY_MESSAGES:40,SEND_RATE:2,BATCH_SIZE:10,REQUIRES_VERIFICATION:!1,SUPPORTS_RICH_MEDIA:!0},API:{MAX_DAILY_MESSAGES:null,SEND_RATE:50,BATCH_SIZE:500,REQUIRES_VERIFICATION:!0,SUPPORTS_RICH_MEDIA:!0}}}},function(e){e.O(0,[6539,5762,688,8077,4018,1181,5558,4527,7832,3657,2386,7156,1744],function(){return e(e.s=32482)}),_N_E=e.O()}]);