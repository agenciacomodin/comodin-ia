(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3846],{7874:function(e,a,s){Promise.resolve().then(s.bind(s,20033))},20033:function(e,a,s){"use strict";s.d(a,{default:function(){return _}});var i=s(15444),t=s(89300),n=s(99827),r=s(2422),d=s(61335),l=s(74678),c=s(34635),o=s(67012),m=s(70489),u=s(37108),p=s(56948),x=s(26771),h=s(6488),N=s(64624),E=s(75012),g=s(66124),j=s(51137),f=s(23572),v=s(62492),S=s(18218),A=s(66772),b=s(81178),I=s(80586),C=s(45053),y=s(51181),R=s(95854),T=s(79047),P=s(33186),D=s(81284);function _({onCampaignCreated:e}){let[a,s]=(0,t.useState)(0),[d,l]=(0,t.useState)([]),[c,o]=(0,t.useState)(!0),[m,p]=(0,t.useState)(!1),{toast:A}=(0,R.pm)(),b=(0,T.useRouter)(),[I,C]=(0,t.useState)({type:"IMMEDIATE",sendRate:P.UM.SEND_RATE,batchSize:P.UM.BATCH_SIZE,timezone:"America/Mexico_City"}),[D,_]=(0,t.useState)(null),[F,H]=(0,t.useState)([]),[B,Z]=(0,t.useState)(null),[V,G]=(0,t.useState)({}),W=[{id:"template",title:"Seleccionar Plantilla",description:"Elige la plantilla de mensaje pre-aprobada",icon:x.Z,isCompleted:!!D},{id:"basic",title:"Informaci\xf3n B\xe1sica",description:"Configura los detalles b\xe1sicos de la campa\xf1a",icon:h.Z,isCompleted:!!I.name&&!!I.type},{id:"audience",title:"Constructor de Audiencias",description:"Define tu p\xfablico objetivo con precisi\xf3n",icon:N.Z,isCompleted:F.length>0&&!!B},{id:"schedule",title:"Programaci\xf3n y Env\xedo",description:"Configura cu\xe1ndo y c\xf3mo enviar la campa\xf1a",icon:E.Z,isCompleted:"IMMEDIATE"===I.type||!!I.scheduledFor},{id:"review",title:"Revisi\xf3n y Confirmaci\xf3n",description:"Revisa todos los detalles antes de crear",icon:g.Z,isCompleted:!1}];(0,t.useEffect)(()=>{k()},[]);let k=async()=>{try{let e=await fetch("/api/campaigns/templates?status=APPROVED&isActive=true"),a=await e.json();if(a.success)l(a.data||[]);else throw Error(a.error)}catch(e){console.error("Error loading templates:",e),A({title:"Error",description:"No se pudieron cargar las plantillas",variant:"destructive"})}finally{o(!1)}},z=e=>{let a={};switch(e){case 0:D||(a.template=["Debes seleccionar una plantilla"]);break;case 1:I.name||(a.name=["El nombre de la campa\xf1a es requerido"]),I.type||(a.type=["El tipo de campa\xf1a es requerido"]);break;case 2:0===F.length&&(a.audience=["Debes definir al menos un filtro de audiencia"]),B||(a.preview=["Debes generar una vista previa de la audiencia"]);break;case 3:"SCHEDULED"!==I.type||I.scheduledFor||(a.schedule=["Debes seleccionar una fecha y hora para la campa\xf1a programada"]),I.sendRate&&(I.sendRate<1||I.sendRate>60)&&(a.sendRate=["La velocidad de env\xedo debe estar entre 1 y 60 mensajes por minuto"])}return G(a),0===Object.keys(a).length},Y=async()=>{if(D&&B)try{p(!0);let a=I.sendRate||P.UM.SEND_RATE,s=I.batchSize||P.UM.BATCH_SIZE,i=I.maxRecipients;I.type===y.CampaignType.WHATSAPP_BUSINESS?(a=P.wu.BUSINESS.SEND_RATE,s=P.wu.BUSINESS.BATCH_SIZE,(!i||i>P.wu.BUSINESS.MAX_DAILY_MESSAGES)&&(i=P.wu.BUSINESS.MAX_DAILY_MESSAGES)):I.type===y.CampaignType.WHATSAPP_API&&(a=P.wu.API.SEND_RATE,s=P.wu.API.BATCH_SIZE);let t={name:I.name,description:I.description,type:I.type,templateId:D.id,messageVariables:I.messageVariables||{},audienceFilters:F,maxRecipients:i,scheduledFor:I.scheduledFor?new Date(I.scheduledFor):void 0,timezone:I.timezone||"America/Mexico_City",sendRate:a,batchSize:s,budgetLimit:I.budgetLimit},n=await fetch("/api/campaigns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await n.json();if(r.success)A({title:"\xc9xito",description:"Campa\xf1a creada exitosamente"}),e?.(r.data.id),b.push(`/campaigns/${r.data.id}`);else throw Error(r.error)}catch(e){console.error("Error creating campaign:",e),A({title:"Error",description:"Error al crear la campa\xf1a",variant:"destructive"})}finally{p(!1)}},X=(a+1)/W.length*100;return(0,i.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,i.jsxs)("div",{className:"text-center space-y-2",children:[(0,i.jsx)("h1",{className:"text-3xl font-bold",children:"Crear Nueva Campa\xf1a"}),(0,i.jsx)("p",{className:"text-muted-foreground",children:"Asistente paso a paso para crear campa\xf1as profesionales con segmentaci\xf3n avanzada"}),(0,i.jsx)(u.E,{value:X,className:"max-w-md mx-auto"})]}),(0,i.jsx)(n.Zb,{children:(0,i.jsx)(n.aY,{className:"p-6",children:(0,i.jsx)("div",{className:"flex justify-between items-center",children:W.map((e,s)=>{let t=e.icon,n=s===a,r=e.isCompleted,d=s<a;return(0,i.jsxs)("div",{className:"flex flex-col items-center space-y-2",children:[(0,i.jsx)("div",{className:`
                    relative flex items-center justify-center w-12 h-12 rounded-full border-2 transition-colors
                    ${n?"border-primary bg-primary text-primary-foreground":r||d?"border-green-500 bg-green-500 text-white":"border-muted-foreground/30 text-muted-foreground"}
                  `,children:r||d?(0,i.jsx)(g.Z,{className:"h-6 w-6"}):(0,i.jsx)(t,{className:"h-6 w-6"})}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("p",{className:`text-sm font-medium ${n?"text-primary":"text-muted-foreground"}`,children:e.title}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground hidden sm:block",children:e.description})]})]},e.id)})})})}),(0,i.jsxs)(n.Zb,{children:[(0,i.jsxs)(n.Ol,{children:[(0,i.jsxs)(n.ll,{className:"flex items-center space-x-2",children:[t.createElement(W[a].icon,{className:"h-5 w-5"}),(0,i.jsx)("span",{children:W[a].title})]}),(0,i.jsx)(n.SZ,{children:W[a].description})]}),(0,i.jsx)(n.aY,{className:"space-y-6",children:(()=>{switch(a){case 0:return(0,i.jsx)(w,{templates:d,loading:c,selectedTemplate:D,onSelectTemplate:_,errors:V});case 1:return(0,i.jsx)(O,{data:I,onChange:C,errors:V});case 2:return(0,i.jsx)(L,{filters:F,preview:B,onFiltersChange:H,onPreviewChange:Z,errors:V});case 3:return(0,i.jsx)(U,{data:I,onChange:C,audienceSize:B?.totalContacts||0,errors:V});case 4:return(0,i.jsx)(M,{campaignData:I,selectedTemplate:D,audiencePreview:B,audienceFilters:F,onCreateCampaign:Y,creating:m});default:return null}})()})]}),(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsxs)(r.z,{variant:"outline",onClick:()=>{a>0&&s(a-1)},disabled:0===a,children:[(0,i.jsx)(j.Z,{className:"mr-2 h-4 w-4"}),"Anterior"]}),a<W.length-1?(0,i.jsxs)(r.z,{onClick:()=>{z(a)&&a<W.length-1&&s(a+1)},children:["Siguiente",(0,i.jsx)(f.Z,{className:"ml-2 h-4 w-4"})]}):(0,i.jsx)(r.z,{onClick:Y,disabled:m||!z(a),className:"bg-green-600 hover:bg-green-700",children:m?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(v.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Creando..."]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(S.Z,{className:"mr-2 h-4 w-4"}),"Crear Campa\xf1a"]})})]})]})}function w({templates:e,loading:a,selectedTemplate:s,onSelectTemplate:t,errors:r}){return a?(0,i.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((e,a)=>(0,i.jsx)("div",{className:"animate-pulse",children:(0,i.jsx)("div",{className:"h-20 bg-gray-200 rounded-lg"})},a))}):0===e.length?(0,i.jsxs)(p.bZ,{children:[(0,i.jsx)(A.Z,{className:"h-4 w-4"}),(0,i.jsx)(p.X,{children:"No hay plantillas aprobadas disponibles. Necesitas crear y aprobar plantillas antes de crear campa\xf1as."})]}):(0,i.jsxs)("div",{className:"space-y-4",children:[r.template&&(0,i.jsxs)(p.bZ,{variant:"destructive",children:[(0,i.jsx)(A.Z,{className:"h-4 w-4"}),(0,i.jsx)(p.X,{children:r.template[0]})]}),(0,i.jsx)("div",{className:"grid gap-4",children:e.map(e=>(0,i.jsx)(n.Zb,{className:`cursor-pointer transition-colors ${s?.id===e.id?"border-primary bg-primary/5":"hover:border-primary/50"}`,onClick:()=>t(e),children:(0,i.jsx)(n.aY,{className:"p-4",children:(0,i.jsxs)("div",{className:"flex items-start justify-between",children:[(0,i.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("h3",{className:"font-medium",children:e.name}),(0,i.jsx)(d.C,{variant:"secondary",className:"text-xs",children:e.category}),(0,i.jsx)(d.C,{variant:"outline",className:"text-xs",children:e.language.toUpperCase()})]}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2",children:e.bodyContent}),(0,i.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-muted-foreground",children:[(0,i.jsxs)("span",{children:["Usado ",e.usageCount," veces"]}),e.successfulSends>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{children:"•"}),(0,i.jsxs)("span",{children:[e.successfulSends," env\xedos exitosos"]})]})]})]}),s?.id===e.id&&(0,i.jsx)("div",{className:"ml-4",children:(0,i.jsx)(g.Z,{className:"h-5 w-5 text-primary"})})]})})},e.id))})]})}function O({data:e,onChange:a,errors:s}){return(0,i.jsxs)("div",{className:"space-y-6",children:[(s.name||s.type)&&(0,i.jsxs)(p.bZ,{variant:"destructive",children:[(0,i.jsx)(A.Z,{className:"h-4 w-4"}),(0,i.jsx)(p.X,{children:s.name?.[0]||s.type?.[0]})]}),(0,i.jsxs)("div",{className:"grid gap-4",children:[(0,i.jsxs)("div",{className:"grid gap-2",children:[(0,i.jsx)(c.Label,{htmlFor:"campaign-name",children:"Nombre de la campa\xf1a *"}),(0,i.jsx)(l.I,{id:"campaign-name",placeholder:"Ej: Promoci\xf3n Black Friday 2024",value:e.name||"",onChange:s=>a({...e,name:s.target.value}),className:s.name?"border-red-500":""})]}),(0,i.jsxs)("div",{className:"grid gap-2",children:[(0,i.jsx)(c.Label,{htmlFor:"campaign-description",children:"Descripci\xf3n (opcional)"}),(0,i.jsx)(o.g,{id:"campaign-description",placeholder:"Describe el objetivo y detalles de la campa\xf1a...",value:e.description||"",onChange:s=>a({...e,description:s.target.value}),rows:3})]}),(0,i.jsxs)("div",{className:"grid gap-2",children:[(0,i.jsx)(c.Label,{htmlFor:"campaign-type",children:"Tipo de campa\xf1a *"}),(0,i.jsxs)(m.Ph,{value:e.type,onValueChange:s=>a({...e,type:s}),children:[(0,i.jsx)(m.i4,{className:s.type?"border-red-500":"",children:(0,i.jsx)(m.ki,{placeholder:"Selecciona el tipo de campa\xf1a"})}),(0,i.jsxs)(m.Bw,{children:[(0,i.jsx)(m.Ql,{value:"IMMEDIATE",children:(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("div",{className:"font-medium",children:P.Rh.IMMEDIATE}),(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"Env\xedo inmediato una vez confirmada"})]})}),(0,i.jsx)(m.Ql,{value:"SCHEDULED",children:(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("div",{className:"font-medium",children:P.Rh.SCHEDULED}),(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"Programar para una fecha y hora espec\xedfica"})]})}),(0,i.jsx)(m.Ql,{value:"DRIP",children:(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("div",{className:"font-medium",children:P.Rh.DRIP}),(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"Campa\xf1a secuencial con m\xfaltiples mensajes"})]})}),(0,i.jsx)(m.Ql,{value:"AB_TEST",children:(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("div",{className:"font-medium",children:P.Rh.AB_TEST}),(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"Prueba A/B para optimizar mensajes"})]})}),(0,i.jsx)(m.Ql,{value:"WHATSAPP_BUSINESS",children:(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("div",{className:"font-medium",children:P.Rh.WHATSAPP_BUSINESS}),(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"M\xe1ximo 40 mensajes/d\xeda, cualquier contenido"})]})}),(0,i.jsx)(m.Ql,{value:"WHATSAPP_API",children:(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("div",{className:"font-medium",children:P.Rh.WHATSAPP_API}),(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:"Env\xedo ilimitado, solo plantillas verificadas"})]})})]})]})]}),(e.type===y.CampaignType.WHATSAPP_BUSINESS||e.type===y.CampaignType.WHATSAPP_API)&&(0,i.jsxs)("div",{className:"rounded-lg border bg-gradient-to-r from-green-50 to-blue-50 p-4",children:[(0,i.jsxs)("h4",{className:"font-medium text-gray-900 mb-2",children:[e.type===y.CampaignType.WHATSAPP_BUSINESS?"WhatsApp Business":"WhatsApp API"," - Caracter\xedsticas"]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("span",{className:"font-medium",children:"L\xedmite diario:"}),(0,i.jsx)(d.C,{variant:"WHATSAPP_BUSINESS"===e.type?"destructive":"default",children:"WHATSAPP_BUSINESS"===e.type?"40 mensajes":"Ilimitado"})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("span",{className:"font-medium",children:"Plantillas:"}),(0,i.jsx)(d.C,{variant:"WHATSAPP_BUSINESS"===e.type?"default":"outline",children:"WHATSAPP_BUSINESS"===e.type?"No requeridas":"Solo verificadas"})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("span",{className:"font-medium",children:"Velocidad:"}),(0,i.jsx)("span",{className:"text-gray-600",children:"WHATSAPP_BUSINESS"===e.type?"2 msg/min":"50 msg/min"})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("span",{className:"font-medium",children:"Multimedia:"}),(0,i.jsx)("span",{className:"text-green-600",children:"✓ Soportado"})]})]})]}),(0,i.jsx)("div",{className:"mt-3 p-3 bg-white/50 rounded border border-gray-200",children:(0,i.jsxs)("p",{className:"text-xs text-gray-600",children:[(0,i.jsx)("strong",{children:"Recomendaci\xf3n:"})," ",P.C2[e.type]]})})]}),(0,i.jsxs)("div",{className:"grid gap-2",children:[(0,i.jsx)(c.Label,{htmlFor:"max-recipients",children:"L\xedmite m\xe1ximo de destinatarios (opcional)"}),(0,i.jsx)(l.I,{id:"max-recipients",type:"number",placeholder:"Ej: 5000",value:e.maxRecipients||"",onChange:s=>a({...e,maxRecipients:s.target.value?parseInt(s.target.value):void 0}),min:"1",max:"50000"}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:"\xdatil para pruebas A/B o env\xedos graduales. Deja en blanco para enviar a toda la audiencia."})]})]})]})}function L({filters:e,preview:a,onFiltersChange:s,onPreviewChange:t,errors:n}){return(0,i.jsxs)("div",{className:"space-y-4",children:[(n.audience||n.preview)&&(0,i.jsxs)(p.bZ,{variant:"destructive",children:[(0,i.jsx)(A.Z,{className:"h-4 w-4"}),(0,i.jsx)(p.X,{children:n.audience?.[0]||n.preview?.[0]})]}),(0,i.jsx)(D.default,{initialFilters:e,onFiltersChange:s,onPreviewGenerated:t})]})}function U({data:e,onChange:a,audienceSize:s,errors:t}){let r=s&&e.sendRate?Math.ceil(s/e.sendRate):0;return(0,i.jsxs)("div",{className:"space-y-6",children:[(t.schedule||t.sendRate)&&(0,i.jsxs)(p.bZ,{variant:"destructive",children:[(0,i.jsx)(A.Z,{className:"h-4 w-4"}),(0,i.jsx)(p.X,{children:t.schedule?.[0]||t.sendRate?.[0]})]}),"SCHEDULED"===e.type&&(0,i.jsxs)("div",{className:"grid gap-2",children:[(0,i.jsx)(c.Label,{htmlFor:"scheduled-for",children:"Fecha y hora de env\xedo *"}),(0,i.jsx)(l.I,{id:"scheduled-for",type:"datetime-local",value:e.scheduledFor?"string"==typeof e.scheduledFor?e.scheduledFor:e.scheduledFor.toISOString().slice(0,16):"",onChange:s=>a({...e,scheduledFor:s.target.value?new Date(s.target.value):void 0}),className:t.schedule?"border-red-500":"",min:new Date().toISOString().slice(0,16)})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{className:"grid gap-2",children:[(0,i.jsx)(c.Label,{htmlFor:"send-rate",children:"Velocidad de env\xedo (mensajes/minuto)"}),(0,i.jsx)(l.I,{id:"send-rate",type:"number",value:e.sendRate||P.UM.SEND_RATE,onChange:s=>a({...e,sendRate:parseInt(s.target.value)}),min:"1",max:"60",className:t.sendRate?"border-red-500":""}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:"Controla la velocidad para evitar saturar los servidores"})]}),(0,i.jsxs)("div",{className:"grid gap-2",children:[(0,i.jsx)(c.Label,{htmlFor:"batch-size",children:"Tama\xf1o de lote"}),(0,i.jsx)(l.I,{id:"batch-size",type:"number",value:e.batchSize||P.UM.BATCH_SIZE,onChange:s=>a({...e,batchSize:parseInt(s.target.value)}),min:"10",max:"1000"}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:"N\xfamero de mensajes procesados en cada lote"})]})]}),(0,i.jsxs)("div",{className:"grid gap-2",children:[(0,i.jsx)(c.Label,{htmlFor:"budget-limit",children:"L\xedmite de presupuesto (USD, opcional)"}),(0,i.jsx)(l.I,{id:"budget-limit",type:"number",step:"0.01",placeholder:"Ej: 100.00",value:e.budgetLimit||"",onChange:s=>a({...e,budgetLimit:s.target.value?parseFloat(s.target.value):void 0}),min:"0"}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:"La campa\xf1a se pausar\xe1 autom\xe1ticamente si se alcanza este l\xedmite"})]}),s>0&&(0,i.jsx)(n.Zb,{className:"bg-blue-50 border-blue-200",children:(0,i.jsxs)(n.aY,{className:"p-4",children:[(0,i.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"Estimaci\xf3n de Campa\xf1a"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"text-blue-700",children:"Audiencia:"}),(0,i.jsxs)("p",{className:"font-medium",children:[s.toLocaleString()," contactos"]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"text-blue-700",children:"Duraci\xf3n estimada:"}),(0,i.jsxs)("p",{className:"font-medium",children:[r," minutos"]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"text-blue-700",children:"Costo estimado:"}),(0,i.jsx)("p",{className:"font-medium",children:"$0.05 - $0.15 USD"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"text-blue-700",children:"Entrega estimada:"}),(0,i.jsx)("p",{className:"font-medium",children:"85% - 95%"})]})]})]})})]})}function M({campaignData:e,selectedTemplate:a,audiencePreview:s,audienceFilters:t,onCreateCampaign:l,creating:c}){return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)(p.bZ,{children:[(0,i.jsx)(g.Z,{className:"h-4 w-4"}),(0,i.jsx)(p.X,{children:"Revisa cuidadosamente todos los detalles antes de crear la campa\xf1a. Una vez creada, algunos elementos no podr\xe1n modificarse."})]}),(0,i.jsxs)("div",{className:"grid gap-6",children:[(0,i.jsxs)(n.Zb,{children:[(0,i.jsx)(n.Ol,{children:(0,i.jsx)(n.ll,{className:"text-base",children:"Informaci\xf3n de la Campa\xf1a"})}),(0,i.jsxs)(n.aY,{className:"space-y-3",children:[(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-muted-foreground",children:"Nombre:"}),(0,i.jsx)("span",{className:"font-medium",children:e.name})]}),(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-muted-foreground",children:"Tipo:"}),(0,i.jsx)(d.C,{variant:"secondary",children:P.Rh[e.type]})]}),e.description&&(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-muted-foreground",children:"Descripci\xf3n:"}),(0,i.jsx)("span",{className:"font-medium text-right max-w-xs",children:e.description})]}),e.scheduledFor&&(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-muted-foreground",children:"Programada para:"}),(0,i.jsx)("span",{className:"font-medium",children:(0,I.WU)(new Date(e.scheduledFor),"dd/MM/yyyy HH:mm",{locale:C.es})})]})]})]}),(0,i.jsxs)(n.Zb,{children:[(0,i.jsx)(n.Ol,{children:(0,i.jsx)(n.ll,{className:"text-base",children:"Plantilla Seleccionada"})}),(0,i.jsx)(n.aY,{children:a&&(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("span",{className:"font-medium",children:a.name}),(0,i.jsx)(d.C,{variant:"outline",className:"text-xs",children:a.category})]}),(0,i.jsx)("div",{className:"p-3 bg-gray-50 rounded-lg",children:(0,i.jsx)("p",{className:"text-sm",children:a.bodyContent})}),(0,i.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Usado ",a.usageCount," veces • ",a.successfulSends," env\xedos exitosos"]})]})})]}),(0,i.jsxs)(n.Zb,{children:[(0,i.jsx)(n.Ol,{children:(0,i.jsx)(n.ll,{className:"text-base",children:"Audiencia Objetivo"})}),(0,i.jsx)(n.aY,{children:s&&(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)("span",{className:"font-medium text-lg",children:[s.totalContacts.toLocaleString()," contactos"]}),(0,i.jsxs)(d.C,{variant:"outline",children:[s.vipCount," VIP"]})]}),(0,i.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Filtros aplicados: ",t.length," criterio",1!==t.length?"s":""]}),(0,i.jsxs)("div",{className:"space-y-1",children:[t.slice(0,3).map((e,a)=>(0,i.jsxs)("div",{className:"text-xs text-muted-foreground",children:["• ",P.mT[e.type]]},a)),t.length>3&&(0,i.jsxs)("div",{className:"text-xs text-muted-foreground",children:["... y ",t.length-3," filtro",t.length-3!=1?"s":""," m\xe1s"]})]})]})})]}),(0,i.jsxs)(n.Zb,{children:[(0,i.jsx)(n.Ol,{children:(0,i.jsx)(n.ll,{className:"text-base",children:"Configuraci\xf3n de Env\xedo"})}),(0,i.jsxs)(n.aY,{className:"space-y-3",children:[(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-muted-foreground",children:"Velocidad:"}),(0,i.jsxs)("span",{className:"font-medium",children:[e.sendRate," mensajes/minuto"]})]}),(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-muted-foreground",children:"Tama\xf1o de lote:"}),(0,i.jsxs)("span",{className:"font-medium",children:[e.batchSize," mensajes"]})]}),e.maxRecipients&&(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-muted-foreground",children:"L\xedmite m\xe1ximo:"}),(0,i.jsxs)("span",{className:"font-medium",children:[e.maxRecipients.toLocaleString()," contactos"]})]}),e.budgetLimit&&(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-muted-foreground",children:"L\xedmite de presupuesto:"}),(0,i.jsxs)("span",{className:"font-medium",children:["$",e.budgetLimit," USD"]})]})]})]})]}),(0,i.jsx)("div",{className:"flex justify-center pt-4",children:(0,i.jsx)(r.z,{onClick:l,disabled:c,size:"lg",className:"bg-green-600 hover:bg-green-700 min-w-[200px]",children:c?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(v.Z,{className:"mr-2 h-5 w-5 animate-spin"}),"Creando Campa\xf1a..."]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(b.Z,{className:"mr-2 h-5 w-5"}),"Crear Campa\xf1a"]})})})]})}},56948:function(e,a,s){"use strict";s.d(a,{Cd:function(){return c},X:function(){return o},bZ:function(){return l}});var i=s(15444),t=s(89300),n=s(2371),r=s(65522);let d=(0,n.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=t.forwardRef(({className:e,variant:a,...s},t)=>(0,i.jsx)("div",{ref:t,role:"alert",className:(0,r.cn)(d({variant:a}),e),...s}));l.displayName="Alert";let c=t.forwardRef(({className:e,...a},s)=>(0,i.jsx)("h5",{ref:s,className:(0,r.cn)("mb-1 font-medium leading-none tracking-tight",e),...a}));c.displayName="AlertTitle";let o=t.forwardRef(({className:e,...a},s)=>(0,i.jsx)("div",{ref:s,className:(0,r.cn)("text-sm [&_p]:leading-relaxed",e),...a}));o.displayName="AlertDescription"},74678:function(e,a,s){"use strict";s.d(a,{I:function(){return r}});var i=s(15444),t=s(89300),n=s(65522);let r=t.forwardRef(({className:e,type:a,...s},t)=>(0,i.jsx)("input",{type:a,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:t,...s}));r.displayName="Input"},37108:function(e,a,s){"use strict";s.d(a,{E:function(){return d}});var i=s(15444),t=s(89300),n=s(25052),r=s(65522);let d=t.forwardRef(({className:e,value:a,...s},t)=>(0,i.jsx)(n.fC,{ref:t,className:(0,r.cn)("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",e),...s,children:(0,i.jsx)(n.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})}));d.displayName=n.fC.displayName},67012:function(e,a,s){"use strict";s.d(a,{g:function(){return r}});var i=s(15444),t=s(89300),n=s(65522);let r=t.forwardRef(({className:e,...a},s)=>(0,i.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...a}));r.displayName="Textarea"},33186:function(e,a,s){"use strict";s.d(a,{BT:function(){return n.AutomationActionType},C2:function(){return T},DX:function(){return I},Dn:function(){return C},ED:function(){return x},Eb:function(){return g},FQ:function(){return j},Go:function(){return d},Jg:function(){return h},Om:function(){return m},Pg:function(){return S},Rh:function(){return R},Rn:function(){return E},Sn:function(){return c},UM:function(){return D},Ug:function(){return A},Vb:function(){return n.AutomationConditionType},WC:function(){return l},WV:function(){return b},WY:function(){return r},aE:function(){return u},d1:function(){return N},fB:function(){return o},hC:function(){return n.KnowledgeSourceStatus},hQ:function(){return f},mT:function(){return P},n9:function(){return p},rH:function(){return n.KnowledgeSourceType},uU:function(){return y},wu:function(){return _},ym:function(){return v}});var i,t,n=s(51181);(i=t||(t={})).INSUFFICIENT_BALANCE="INSUFFICIENT_BALANCE",i.NO_PROVIDER_AVAILABLE="NO_PROVIDER_AVAILABLE",i.PROVIDER_ERROR="PROVIDER_ERROR",i.INVALID_REQUEST="INVALID_REQUEST",i.RATE_LIMIT_EXCEEDED="RATE_LIMIT_EXCEEDED",i.INTERNAL_ERROR="INTERNAL_ERROR";let r={OPEN:"Abierta",PENDING:"Pendiente",RESOLVED:"Resuelta",TRANSFERRED:"Transferida",ARCHIVED:"Archivada"},d={LOW:"Baja",MEDIUM:"Media",HIGH:"Alta",URGENT:"Urgente"},l={LOW:"gray",MEDIUM:"blue",HIGH:"orange",URGENT:"red"},c={QR_CODE:"Conexi\xf3n R\xe1pida (QR)",API_OFFICIAL:"Conexi\xf3n Profesional (API)"},o={DISCONNECTED:"Desconectado",CONNECTING:"Conectando",CONNECTED:"Conectado",ERROR:"Error",EXPIRED:"Expirado"},m={DISCONNECTED:"gray",CONNECTING:"yellow",CONNECTED:"green",ERROR:"red",EXPIRED:"orange"},u={image:["image/jpeg","image/png","image/gif","image/webp"],document:["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain"],video:["video/mp4","video/avi","video/mov","video/wmv"],audio:["audio/mp3","audio/wav","audio/aac","audio/ogg"]},p={image:10485760,document:52428800,video:104857600,audio:20971520},x={SALES:"Ventas",SUPPORT:"Soporte",QUESTION:"Pregunta",COMPLAINT:"Queja",BOOKING:"Reserva",PAYMENT:"Pago",INFORMATION:"Informaci\xf3n",GREETING:"Saludo",FAREWELL:"Despedida",OTHER:"Otro"},h={SALES:"green",SUPPORT:"blue",QUESTION:"yellow",COMPLAINT:"red",BOOKING:"purple",PAYMENT:"orange",INFORMATION:"cyan",GREETING:"teal",FAREWELL:"gray",OTHER:"slate"},N={INTENTION_DETECTED:"Intenci\xf3n detectada",KEYWORDS_CONTAINS:"Contiene palabras clave",SENDER_IS_VIP:"Remitente es VIP",TIME_RANGE:"Horario espec\xedfico",FIRST_MESSAGE:"Primer mensaje",MESSAGE_COUNT:"N\xfamero de mensajes",RESPONSE_TIME:"Tiempo de respuesta"},E={ADD_TAG:"Agregar etiqueta",ASSIGN_AGENT:"Asignar agente",SET_PRIORITY:"Establecer prioridad",AUTO_REPLY:"Respuesta autom\xe1tica",MARK_VIP:"Marcar como VIP",TRANSFER_CONVERSATION:"Transferir conversaci\xf3n",CREATE_TASK:"Crear tarea",SEND_NOTIFICATION:"Enviar notificaci\xf3n"},g={pdf:["application/pdf"],document:["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],text:["text/plain","text/markdown","text/csv"],web:["text/html"]},j=52428800,f={UPLOADING:"Subiendo",PROCESSING:"Procesando",CHUNKING:"Fragmentando",EMBEDDING:"Generando Embeddings",ACTIVE:"Activo",ERROR:"Error",DISABLED:"Deshabilitado"},v={ECOMMERCE:"E-commerce",CRM:"CRM",ERP:"ERP",PAYMENT:"Pagos",ANALYTICS:"An\xe1lisis",MARKETING:"Marketing",SOCIAL_MEDIA:"Redes Sociales",EMAIL:"Email Marketing",SUPPORT:"Soporte",OTHER:"Otros"},S={AVAILABLE:"Disponible",CONNECTED:"Conectado",DISCONNECTED:"Desconectado",ERROR:"Error",PENDING:"Pendiente"},A={SHOPIFY:{displayName:"Shopify",description:"Conecta tu tienda Shopify para consultar productos, pedidos e inventario",authType:"oauth",authFields:["shop_domain","access_token"],iconUrl:"/integrations/shopify.svg",brandColor:"#7AB55C",supportedFeatures:["products","orders","customers","inventory"],documentation:"https://docs.shopify.com/api"},WOOCOMMERCE:{displayName:"WooCommerce",description:"Conecta tu tienda WooCommerce para gestionar productos y pedidos",authType:"api_key",authFields:["site_url","consumer_key","consumer_secret"],iconUrl:"/integrations/woocommerce.svg",brandColor:"#7F54B3",supportedFeatures:["products","orders","customers"],documentation:"https://woocommerce.github.io/woocommerce-rest-api-docs/"},TIENDANUBE:{displayName:"TiendaNube",description:"Conecta tu tienda TiendaNube para sincronizar cat\xe1logo y pedidos",authType:"oauth",authFields:["store_id","access_token"],iconUrl:"/integrations/tiendanube.svg",brandColor:"#FF6900",supportedFeatures:["products","orders","customers"],documentation:"https://developers.tiendanube.com/"}},b={PENDING:"Pendiente",APPROVED:"Aprobada",REJECTED:"Rechazada",PAUSED:"Pausada",ARCHIVED:"Archivada"},I={PENDING:"yellow",APPROVED:"green",REJECTED:"red",PAUSED:"orange",ARCHIVED:"gray"},C={DRAFT:"Borrador",SCHEDULED:"Programada",SENDING:"Enviando",COMPLETED:"Completada",PAUSED:"Pausada",CANCELLED:"Cancelada",FAILED:"Fallida"},y={DRAFT:"gray",SCHEDULED:"blue",SENDING:"yellow",COMPLETED:"green",PAUSED:"orange",CANCELLED:"red",FAILED:"red"},R={IMMEDIATE:"Inmediato",SCHEDULED:"Programado",DRIP:"Secuencial",AB_TEST:"Prueba A/B",WHATSAPP_BUSINESS:"WhatsApp Business",WHATSAPP_API:"WhatsApp API"},T={IMMEDIATE:"Env\xedo inmediato a todos los destinatarios",SCHEDULED:"Env\xedo programado para una fecha espec\xedfica",DRIP:"Env\xedo secuencial con intervalos definidos",AB_TEST:"Prueba diferentes versiones del mensaje",WHATSAPP_BUSINESS:"M\xe1ximo 40 mensajes diarios, cualquier contenido (texto/imagen/video/audio)",WHATSAPP_API:"Env\xedo ilimitado, solo plantillas verificadas por Meta"},P={INCLUDE_TAG:"Incluir etiqueta",EXCLUDE_TAG:"Excluir etiqueta",CHANNEL:"Canal de origen",VIP_STATUS:"Estado VIP",LAST_CONTACT:"\xdaltimo contacto",CONVERSATION_STATUS:"Estado de conversaci\xf3n"},D={SEND_RATE:10,BATCH_SIZE:100,RETRY_ATTEMPTS:3,PREVIEW_SAMPLE_SIZE:20,PREVIEW_EXPIRATION_HOURS:24},_={BUSINESS:{MAX_DAILY_MESSAGES:40,SEND_RATE:2,BATCH_SIZE:10,REQUIRES_VERIFICATION:!1,SUPPORTS_RICH_MEDIA:!0},API:{MAX_DAILY_MESSAGES:null,SEND_RATE:50,BATCH_SIZE:500,REQUIRES_VERIFICATION:!0,SUPPORTS_RICH_MEDIA:!0}}}},function(e){e.O(0,[6539,688,8077,8151,822,1181,1762,3331,353,1284,2386,7156,1744],function(){return e(e.s=7874)}),_N_E=e.O()}]);