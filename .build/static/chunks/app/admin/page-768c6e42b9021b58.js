(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{10474:function(e,r,s){Promise.resolve().then(s.bind(s,59342)),Promise.resolve().then(s.bind(s,97082))},59342:function(e,r,s){"use strict";s.d(r,{AICacheManager:function(){return g}});var a=s(15444),i=s(89300),t=s(2422),n=s(99827),o=s(61335),l=s(92232),d=s(56948),c=s(27953),m=s(1946),u=s(40563),x=s(26378),p=s(62492),h=s(83648),f=s(64611);function g(){let[e,r]=(0,i.useState)(null),[s,g]=(0,i.useState)(!0),[j,v]=(0,i.useState)(!1),b=async()=>{try{let e=await fetch("/api/admin/ai-cache"),s=await e.json();s.success?r(s.stats):f.Am.error("Error cargando estad\xedsticas del cach\xe9")}catch(e){console.error("Error loading cache stats:",e),f.Am.error("Error de conexi\xf3n")}finally{g(!1)}},y=async()=>{if(confirm("\xbfEst\xe1s seguro de que quieres purgar todo el cach\xe9 de IA? Esta acci\xf3n no se puede deshacer.")){v(!0);try{let e=await fetch("/api/admin/ai-cache",{method:"DELETE"}),r=await e.json();r.success?(f.Am.success(`✅ ${r.message}`),await b()):f.Am.error(`❌ Error: ${r.error}`)}catch(e){console.error("Error purging cache:",e),f.Am.error("❌ Error de conexi\xf3n al purgar cach\xe9")}finally{v(!1)}}};return((0,i.useEffect)(()=>{b()},[]),s)?(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{children:[(0,a.jsxs)(n.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(c.Z,{className:"w-5 h-5"}),"Cach\xe9 Inteligente de IA"]}),(0,a.jsx)(n.SZ,{children:"Cargando estad\xedsticas del cach\xe9..."})]}),(0,a.jsx)(n.aY,{children:(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)(m.Z,{className:"w-8 h-8 animate-spin text-gray-400"})})})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(n.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(c.Z,{className:"w-5 h-5 text-purple-600"}),"Cach\xe9 Inteligente de IA"]}),(0,a.jsx)(n.SZ,{children:"Sistema de optimizaci\xf3n de costos mediante cache de respuestas repetitivas"})]}),(0,a.jsxs)(t.z,{onClick:y,disabled:j,variant:"destructive",size:"sm",className:"flex items-center gap-2",children:[j?(0,a.jsx)(m.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(u.Z,{className:"w-4 h-4"}),"Purgar Cach\xe9"]})]})}),(0,a.jsx)(n.aY,{children:(0,a.jsxs)(d.bZ,{className:"border-purple-200 bg-purple-50",children:[(0,a.jsx)(c.Z,{className:"w-4 h-4 text-purple-600"}),(0,a.jsxs)(d.X,{className:"text-purple-700",children:[(0,a.jsx)("strong",{children:"Optimizaci\xf3n Activa:"})," El sistema almacena respuestas de IA comunes y las sirve con una tarifa simb\xf3lica (10% del costo original), reduciendo dr\xe1sticamente los gastos operativos."]})]})})]}),e&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)(n.Zb,{children:(0,a.jsx)(n.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Entradas en Cach\xe9"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.totalEntries.toLocaleString()})]}),(0,a.jsx)("div",{className:"p-3 bg-blue-100 rounded-full",children:(0,a.jsx)(c.Z,{className:"w-6 h-6 text-blue-600"})})]})})}),(0,a.jsx)(n.Zb,{children:(0,a.jsx)(n.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Usos del Cach\xe9"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.totalHits.toLocaleString()})]}),(0,a.jsx)("div",{className:"p-3 bg-green-100 rounded-full",children:(0,a.jsx)(x.Z,{className:"w-6 h-6 text-green-600"})})]})})}),(0,a.jsx)(n.Zb,{children:(0,a.jsx)(n.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Tasa de Hit"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[e.averageHitRate.toFixed(1),"x"]})]}),(0,a.jsx)("div",{className:"p-3 bg-orange-100 rounded-full",children:(0,a.jsx)(p.Z,{className:"w-6 h-6 text-orange-600"})})]})})}),(0,a.jsx)(n.Zb,{children:(0,a.jsx)(n.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Ahorro Total"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:["$",e.totalSavings.toFixed(2)]})]}),(0,a.jsx)("div",{className:"p-3 bg-green-100 rounded-full",children:(0,a.jsx)(h.Z,{className:"w-6 h-6 text-green-600"})})]})})})]}),e.topCachedQueries.length>0&&(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{children:[(0,a.jsx)(n.ll,{className:"text-lg",children:"Consultas M\xe1s Cachadas"}),(0,a.jsx)(n.SZ,{children:"Las consultas que m\xe1s se han reutilizado desde el cach\xe9"})]}),(0,a.jsx)(n.aY,{children:(0,a.jsx)("div",{className:"space-y-4",children:e.topCachedQueries.map((e,r)=>(0,a.jsx)("div",{className:"flex items-start justify-between p-4 border rounded-lg",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsxs)(o.C,{variant:"secondary",children:["#",r+1]}),(0,a.jsxs)(o.C,{variant:"outline",children:[e.hitCount," uso",1!==e.hitCount?"s":""]})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 leading-relaxed",children:e.response}),(0,a.jsxs)("p",{className:"text-xs text-gray-400 mt-2 font-mono",children:["Hash: ",e.promptHash.substring(0,16),"..."]})]})},e.promptHash))})})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{children:(0,a.jsx)(n.ll,{className:"text-lg",children:"Informaci\xf3n del Sistema"})}),(0,a.jsxs)(n.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-700",children:"Tarifa de Cach\xe9:"}),(0,a.jsx)("p",{className:"text-gray-600",children:"10% del costo original de la IA"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-700",children:"Expiraci\xf3n:"}),(0,a.jsx)("p",{className:"text-gray-600",children:"30 d\xedas por defecto"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-700",children:"Algoritmo de Hash:"}),(0,a.jsx)("p",{className:"text-gray-600",children:"MD5 normalizado"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-700",children:"Ahorro Promedio:"}),(0,a.jsx)("p",{className:"text-gray-600",children:"90% del costo original por hit"})]})]}),(0,a.jsx)(l.Z,{}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Funcionamiento del Sistema"}),(0,a.jsxs)("ol",{className:"text-sm text-gray-600 space-y-1 list-decimal list-inside",children:[(0,a.jsx)("li",{children:"Se genera un hash normalizado del prompt del usuario"}),(0,a.jsx)("li",{children:"Se busca una respuesta existente en el cach\xe9 de la organizaci\xf3n"}),(0,a.jsx)("li",{children:"Si existe: se devuelve la respuesta y se cobra tarifa simb\xf3lica (10%)"}),(0,a.jsx)("li",{children:"Si no existe: se procesa normalmente y se guarda en cach\xe9"})]})]})]})]})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsxs)(t.z,{onClick:b,variant:"outline",className:"flex items-center gap-2",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4"}),"Actualizar Estad\xedsticas"]})})]})}},97082:function(e,r,s){"use strict";s.d(r,{AIProvidersManager:function(){return z}});var a=s(15444),i=s(89300),t=s(2422),n=s(29530),o=s(61335),l=s(91585),d=s(76636),c=s(67748),m=s(5782),u=s(21030),x=s(65522),p=s(34635);let h=d.RV,f=i.createContext({}),g=({...e})=>(0,a.jsx)(f.Provider,{value:{name:e.name},children:(0,a.jsx)(d.Qr,{...e})}),j=()=>{let e=i.useContext(f),r=i.useContext(v),{getFieldState:s,formState:a}=(0,d.Gc)(),t=s(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");let{id:n}=r;return{id:n,name:e.name,formItemId:`${n}-form-item`,formDescriptionId:`${n}-form-item-description`,formMessageId:`${n}-form-item-message`,...t}},v=i.createContext({}),b=i.forwardRef(({className:e,...r},s)=>{let t=i.useId();return(0,a.jsx)(v.Provider,{value:{id:t},children:(0,a.jsx)("div",{ref:s,className:(0,x.cn)("space-y-2",e),...r})})});b.displayName="FormItem";let y=i.forwardRef(({className:e,...r},s)=>{let{error:i,formItemId:t}=j();return(0,a.jsx)(p.Label,{ref:s,className:(0,x.cn)(i&&"text-destructive",e),htmlFor:t,...r})});y.displayName="FormLabel";let N=i.forwardRef(({...e},r)=>{let{error:s,formItemId:i,formDescriptionId:t,formMessageId:n}=j();return(0,a.jsx)(u.g7,{ref:r,id:i,"aria-describedby":s?`${t} ${n}`:`${t}`,"aria-invalid":!!s,...e})});N.displayName="FormControl";let P=i.forwardRef(({className:e,...r},s)=>{let{formDescriptionId:i}=j();return(0,a.jsx)("p",{ref:s,id:i,className:(0,x.cn)("text-sm text-muted-foreground",e),...r})});P.displayName="FormDescription";let w=i.forwardRef(({className:e,children:r,...s},i)=>{let{error:t,formMessageId:n}=j(),o=t?String(t?.message):r;return o?(0,a.jsx)("p",{ref:i,id:n,className:(0,x.cn)("text-sm font-medium text-destructive",e),...s,children:o}):null});w.displayName="FormMessage";var k=s(74678),A=s(67012),C=s(99827);let I=m.z.object({name:m.z.string().min(1,"Nombre requerido").max(50,"Nombre muy largo"),displayName:m.z.string().min(1,"Nombre para mostrar requerido").max(100,"Nombre muy largo"),description:m.z.string().optional(),logoUrl:m.z.string().url("URL inv\xe1lida").optional().or(m.z.literal("")),apiUrl:m.z.string().url("URL de API inv\xe1lida"),apiKeyName:m.z.string().optional(),apiKey:m.z.string().min(10,"Clave API muy corta"),defaultModel:m.z.string().optional(),availableModels:m.z.string().optional(),inputPricePerToken:m.z.string().optional(),outputPricePerToken:m.z.string().optional(),currency:m.z.string().length(3,"C\xf3digo de moneda inv\xe1lido").optional(),maxTokensPerRequest:m.z.string().optional(),rateLimitPerMinute:m.z.string().optional()}),T={openai:{name:"openai",displayName:"OpenAI",description:"Proveedor de GPT-4, GPT-3.5, DALL-E y otros modelos de OpenAI",apiUrl:"https://api.openai.com/v1",logoUrl:"https://pbs.twimg.com/media/G1D1YRnWMAA1jTk.jpg:large",apiKeyName:"API_KEY",defaultModel:"gpt-4o-mini",availableModels:"gpt-4o,gpt-4o-mini,gpt-3.5-turbo",inputPricePerToken:"0.00000150",outputPricePerToken:"0.00000600",currency:"USD",maxTokensPerRequest:"4096",rateLimitPerMinute:"3500"},anthropic:{name:"anthropic",displayName:"Anthropic Claude",description:"Proveedor de Claude 3.5 Sonnet, Claude 3 Haiku y otros modelos de Anthropic",apiUrl:"https://api.anthropic.com/v1",logoUrl:"https://upload.wikimedia.org/wikipedia/commons/thumb/7/78/Anthropic_logo.svg/2560px-Anthropic_logo.svg.png",apiKeyName:"API_KEY",defaultModel:"claude-3-5-sonnet-20241022",availableModels:"claude-3-5-sonnet-20241022,claude-3-haiku-20240307,claude-3-opus-20240229",inputPricePerToken:"0.00000300",outputPricePerToken:"0.00001500",currency:"USD",maxTokensPerRequest:"4096",rateLimitPerMinute:"1000"},google:{name:"google",displayName:"Google AI (Gemini)",description:"Proveedor de Gemini Pro, Gemini Flash y otros modelos de Google",apiUrl:"https://generativelanguage.googleapis.com/v1beta",logoUrl:"https://i.ytimg.com/vi/LI-14hLwHko/mqdefault.jpg",apiKeyName:"API_KEY",defaultModel:"gemini-1.5-flash",availableModels:"gemini-1.5-flash,gemini-1.5-pro,gemini-pro",inputPricePerToken:"0.00000075",outputPricePerToken:"0.00000300",currency:"USD",maxTokensPerRequest:"8192",rateLimitPerMinute:"1500"},cohere:{name:"cohere",displayName:"Cohere",description:"Proveedor de Command R+, Command R y otros modelos de Cohere",apiUrl:"https://api.cohere.ai/v1",logoUrl:"https://upload.wikimedia.org/wikipedia/commons/thumb/a/ad/Cohere_Technologies_Logo.jpg/330px-Cohere_Technologies_Logo.jpg",apiKeyName:"API_KEY",defaultModel:"command-r-plus",availableModels:"command-r-plus,command-r,command",inputPricePerToken:"0.00000300",outputPricePerToken:"0.00001500",currency:"USD",maxTokensPerRequest:"4096",rateLimitPerMinute:"1000"}};function E({provider:e,onSaved:r,onCancel:s}){let[n,o]=(0,i.useState)(!1),[m,u]=(0,i.useState)(null),x=(0,d.cI)({resolver:(0,c.F)(I),defaultValues:{name:e?.name||"",displayName:e?.displayName||"",description:e?.description||"",logoUrl:e?.logoUrl||"",apiUrl:e?.apiUrl||"",apiKeyName:e?.apiKeyName||"API_KEY",apiKey:"",defaultModel:e?.defaultModel||"",availableModels:e?.availableModels?e.availableModels.join(","):"",inputPricePerToken:e?.inputPricePerToken?.toString()||"",outputPricePerToken:e?.outputPricePerToken?.toString()||"",currency:e?.currency||"USD",maxTokensPerRequest:e?.maxTokensPerRequest?.toString()||"",rateLimitPerMinute:e?.rateLimitPerMinute?.toString()||""}}),p=e=>{let r=T[e];r&&(Object.keys(r).forEach(e=>{"apiKey"!==e&&x.setValue(e,r[e])}),u(e))},f=async s=>{try{o(!0);let a={...s,description:s.description||void 0,logoUrl:s.logoUrl||void 0,defaultModel:s.defaultModel||void 0,availableModels:s.availableModels?s.availableModels.split(",").map(e=>e.trim()).filter(Boolean):void 0,inputPricePerToken:s.inputPricePerToken?parseFloat(s.inputPricePerToken):void 0,outputPricePerToken:s.outputPricePerToken?parseFloat(s.outputPricePerToken):void 0,currency:s.currency||"USD",maxTokensPerRequest:s.maxTokensPerRequest?parseInt(s.maxTokensPerRequest):void 0,rateLimitPerMinute:s.rateLimitPerMinute?parseInt(s.rateLimitPerMinute):void 0},i=e?`/api/admin/ai-providers/${e.id}`:"/api/admin/ai-providers",t=await fetch(i,{method:e?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),n=await t.json();if(n.success)l.Am.success(n.message),r();else throw Error(n.error||"Error al guardar proveedor")}catch(e){console.error("Error submitting form:",e),l.Am.error(e instanceof Error?e.message:"Error al guardar proveedor")}finally{o(!1)}};return(0,a.jsx)(h,{...x,children:(0,a.jsxs)("form",{onSubmit:x.handleSubmit(f),className:"space-y-6",children:[!e&&(0,a.jsxs)(C.Zb,{children:[(0,a.jsxs)(C.Ol,{children:[(0,a.jsx)(C.ll,{className:"text-lg",children:"Configuraciones R\xe1pidas"}),(0,a.jsx)(C.SZ,{children:"Utiliza una configuraci\xf3n predefinida para proveedores populares"})]}),(0,a.jsx)(C.aY,{children:(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:Object.entries(T).map(([e,r])=>(0,a.jsx)(t.z,{type:"button",variant:m===e?"default":"outline",size:"sm",onClick:()=>p(e),className:"justify-start",children:r.displayName},e))})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900",children:"Informaci\xf3n B\xe1sica"}),(0,a.jsx)(g,{control:x.control,name:"name",render:({field:e})=>(0,a.jsxs)(b,{children:[(0,a.jsx)(y,{children:"Nombre Interno"}),(0,a.jsx)(N,{children:(0,a.jsx)(k.I,{placeholder:"openai, anthropic, google...",...e})}),(0,a.jsx)(P,{children:"Identificador \xfanico (sin espacios, solo letras y guiones)"}),(0,a.jsx)(w,{})]})}),(0,a.jsx)(g,{control:x.control,name:"displayName",render:({field:e})=>(0,a.jsxs)(b,{children:[(0,a.jsx)(y,{children:"Nombre para Mostrar"}),(0,a.jsx)(N,{children:(0,a.jsx)(k.I,{placeholder:"OpenAI, Claude, Gemini...",...e})}),(0,a.jsx)(P,{children:"Nombre que se mostrar\xe1 en la interfaz"}),(0,a.jsx)(w,{})]})}),(0,a.jsx)(g,{control:x.control,name:"description",render:({field:e})=>(0,a.jsxs)(b,{children:[(0,a.jsx)(y,{children:"Descripci\xf3n (Opcional)"}),(0,a.jsx)(N,{children:(0,a.jsx)(A.g,{placeholder:"Descripci\xf3n del proveedor y sus capacidades...",className:"resize-none",rows:3,...e})}),(0,a.jsx)(w,{})]})}),(0,a.jsx)(g,{control:x.control,name:"logoUrl",render:({field:e})=>(0,a.jsxs)(b,{children:[(0,a.jsx)(y,{children:"URL del Logo (Opcional)"}),(0,a.jsx)(N,{children:(0,a.jsx)(k.I,{placeholder:"https://i.pinimg.com/736x/19/63/c8/1963c80b8983da5f3be640ca7473b098.jpg",...e})}),(0,a.jsx)(w,{})]})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900",children:"Configuraci\xf3n de API"}),(0,a.jsx)(g,{control:x.control,name:"apiUrl",render:({field:e})=>(0,a.jsxs)(b,{children:[(0,a.jsx)(y,{children:"URL de la API"}),(0,a.jsx)(N,{children:(0,a.jsx)(k.I,{placeholder:"https://api.openai.com/v1",...e})}),(0,a.jsx)(P,{children:"URL base para las llamadas a la API"}),(0,a.jsx)(w,{})]})}),(0,a.jsx)(g,{control:x.control,name:"apiKeyName",render:({field:e})=>(0,a.jsxs)(b,{children:[(0,a.jsx)(y,{children:"Nombre de la Clave"}),(0,a.jsx)(N,{children:(0,a.jsx)(k.I,{placeholder:"API_KEY, ACCESS_TOKEN...",...e})}),(0,a.jsx)(P,{children:"Nombre del header para la clave API"}),(0,a.jsx)(w,{})]})}),(0,a.jsx)(g,{control:x.control,name:"apiKey",render:({field:r})=>(0,a.jsxs)(b,{children:[(0,a.jsxs)(y,{children:["Clave API",e&&(0,a.jsx)("span",{className:"text-amber-600 text-sm ml-2",children:"(dejar vac\xedo para mantener actual)"})]}),(0,a.jsx)(N,{children:(0,a.jsx)(k.I,{type:"password",placeholder:e?"••••••••••••":"sk-...",...r})}),(0,a.jsx)(P,{children:"La clave se almacenar\xe1 cifrada de forma segura"}),(0,a.jsx)(w,{})]})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900",children:"Modelos y Configuraci\xf3n"}),(0,a.jsx)(g,{control:x.control,name:"defaultModel",render:({field:e})=>(0,a.jsxs)(b,{children:[(0,a.jsx)(y,{children:"Modelo Por Defecto (Opcional)"}),(0,a.jsx)(N,{children:(0,a.jsx)(k.I,{placeholder:"gpt-4o-mini, claude-3-5-sonnet...",...e})}),(0,a.jsx)(w,{})]})}),(0,a.jsx)(g,{control:x.control,name:"availableModels",render:({field:e})=>(0,a.jsxs)(b,{children:[(0,a.jsx)(y,{children:"Modelos Disponibles (Opcional)"}),(0,a.jsx)(N,{children:(0,a.jsx)(k.I,{placeholder:"modelo1,modelo2,modelo3",...e})}),(0,a.jsx)(P,{children:"Lista separada por comas de modelos disponibles"}),(0,a.jsx)(w,{})]})}),(0,a.jsx)(g,{control:x.control,name:"maxTokensPerRequest",render:({field:e})=>(0,a.jsxs)(b,{children:[(0,a.jsx)(y,{children:"M\xe1x. Tokens por Request (Opcional)"}),(0,a.jsx)(N,{children:(0,a.jsx)(k.I,{type:"number",placeholder:"4096",...e})}),(0,a.jsx)(w,{})]})}),(0,a.jsx)(g,{control:x.control,name:"rateLimitPerMinute",render:({field:e})=>(0,a.jsxs)(b,{children:[(0,a.jsx)(y,{children:"L\xedmite por Minuto (Opcional)"}),(0,a.jsx)(N,{children:(0,a.jsx)(k.I,{type:"number",placeholder:"1000",...e})}),(0,a.jsx)(P,{children:"Requests permitidos por minuto"}),(0,a.jsx)(w,{})]})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900",children:"Configuraci\xf3n de Precios"}),(0,a.jsx)(g,{control:x.control,name:"inputPricePerToken",render:({field:e})=>(0,a.jsxs)(b,{children:[(0,a.jsx)(y,{children:"Precio por Token de Entrada (Opcional)"}),(0,a.jsx)(N,{children:(0,a.jsx)(k.I,{type:"number",step:"0.00000001",placeholder:"0.00000150",...e})}),(0,a.jsx)(P,{children:"Precio en USD por token de entrada"}),(0,a.jsx)(w,{})]})}),(0,a.jsx)(g,{control:x.control,name:"outputPricePerToken",render:({field:e})=>(0,a.jsxs)(b,{children:[(0,a.jsx)(y,{children:"Precio por Token de Salida (Opcional)"}),(0,a.jsx)(N,{children:(0,a.jsx)(k.I,{type:"number",step:"0.00000001",placeholder:"0.00000600",...e})}),(0,a.jsx)(P,{children:"Precio en USD por token de salida"}),(0,a.jsx)(w,{})]})}),(0,a.jsx)(g,{control:x.control,name:"currency",render:({field:e})=>(0,a.jsxs)(b,{children:[(0,a.jsx)(y,{children:"Moneda (Opcional)"}),(0,a.jsx)(N,{children:(0,a.jsx)(k.I,{placeholder:"USD",maxLength:3,...e})}),(0,a.jsx)(P,{children:"C\xf3digo de moneda de 3 letras (USD, EUR...)"}),(0,a.jsx)(w,{})]})})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t",children:[(0,a.jsx)(t.z,{type:"button",variant:"outline",onClick:s,disabled:n,children:"Cancelar"}),(0,a.jsx)(t.z,{type:"submit",disabled:n,className:"bg-red-600 hover:bg-red-700",children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),e?"Actualizando...":"Creando..."]}):e?"Actualizar Proveedor":"Crear Proveedor"})]})]})})}function z(){let[e,r]=(0,i.useState)([]),[s,d]=(0,i.useState)(!0),[c,m]=(0,i.useState)(null),[u,x]=(0,i.useState)(!1);(0,i.useEffect)(()=>{p()},[]);let p=async()=>{try{d(!0);let e=await fetch("/api/admin/ai-providers"),s=await e.json();if(s.success)r(s.data);else throw Error(s.error)}catch(e){l.Am.error("Error al cargar los proveedores de IA"),console.error("Error loading providers:",e)}finally{d(!1)}},h=()=>{p(),x(!1),m(null)},f=async(e,r)=>{try{let s=await fetch(`/api/admin/ai-providers/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"toggle-status",isActive:!r})}),a=await s.json();if(a.success)l.Am.success(a.message),p();else throw Error(a.error)}catch(e){l.Am.error("Error al cambiar el estado del proveedor"),console.error("Error toggling provider status:",e)}},g=async e=>{try{let r=await fetch(`/api/admin/ai-providers/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"set-default"})}),s=await r.json();if(s.success)l.Am.success(s.message),p();else throw Error(s.error)}catch(e){l.Am.error("Error al establecer proveedor por defecto"),console.error("Error setting default provider:",e)}},j=async(e,r)=>{if(window.confirm(`\xbfEst\xe1s seguro de que quieres eliminar el proveedor "${r}"?`))try{let r=await fetch(`/api/admin/ai-providers/${e}`,{method:"DELETE"}),s=await r.json();if(s.success)l.Am.success(s.message),p();else throw Error(s.error)}catch(e){l.Am.error("Error al eliminar el proveedor"),console.error("Error deleting provider:",e)}};return s?(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,a.jsx)("div",{className:"h-6 bg-gray-200 rounded w-1/4"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"})]})]})}):(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Gestor Central de IA"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Configura y gestiona las claves API de los proveedores de IA"})]}),(0,a.jsxs)(n.Vq,{open:u,onOpenChange:x,children:[(0,a.jsx)(n.hg,{asChild:!0,children:(0,a.jsx)(t.z,{className:"bg-red-600 hover:bg-red-700",onClick:()=>m(null),children:"+ A\xf1adir Proveedor"})}),(0,a.jsxs)(n.cZ,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[(0,a.jsxs)(n.fK,{children:[(0,a.jsx)(n.$N,{children:c?"Editar Proveedor de IA":"A\xf1adir Nuevo Proveedor de IA"}),(0,a.jsx)(n.Be,{children:c?"Modifica la configuraci\xf3n del proveedor de IA existente.":"Configura un nuevo proveedor de IA para la plataforma."})]}),(0,a.jsx)(E,{provider:c,onSaved:h,onCancel:()=>{x(!1),m(null)}})]})]})]})}),(0,a.jsx)("div",{className:"p-6",children:0===e.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-2xl",children:"\uD83E\uDD16"})}),(0,a.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No hay proveedores configurados"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"A\xf1ade tu primer proveedor de IA para comenzar."}),(0,a.jsxs)(n.Vq,{open:u,onOpenChange:x,children:[(0,a.jsx)(n.hg,{asChild:!0,children:(0,a.jsx)(t.z,{className:"bg-red-600 hover:bg-red-700",onClick:()=>m(null),children:"+ A\xf1adir Primer Proveedor"})}),(0,a.jsxs)(n.cZ,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[(0,a.jsxs)(n.fK,{children:[(0,a.jsx)(n.$N,{children:"A\xf1adir Nuevo Proveedor de IA"}),(0,a.jsx)(n.Be,{children:"Configura tu primer proveedor de IA para la plataforma."})]}),(0,a.jsx)(E,{provider:null,onSaved:h,onCancel:()=>{x(!1),m(null)}})]})]})]}):(0,a.jsx)("div",{className:"grid gap-6",children:e.map(e=>(0,a.jsx)("div",{className:"border border-gray-200 rounded-lg p-6 hover:shadow-sm transition-shadow",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[e.logoUrl&&(0,a.jsx)("img",{src:e.logoUrl,alt:e.displayName,className:"w-8 h-8 rounded"}),(0,a.jsx)("h4",{className:"text-xl font-semibold text-gray-900",children:e.displayName})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[e.isDefault&&(0,a.jsx)(o.C,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:"Por Defecto"}),(0,a.jsx)(o.C,{variant:e.isActive?"default":"secondary",className:e.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:e.isActive?"Activo":"Inactivo"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Nombre interno:"})," ",e.name]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"URL API:"})," ",e.apiUrl]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Clave API:"})," ",e.maskedApiKey]})]}),(0,a.jsxs)("div",{children:[e.defaultModel&&(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Modelo por defecto:"})," ",e.defaultModel]}),e.inputPricePerToken&&(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Precio entrada:"})," $",e.inputPricePerToken.toString()," por token"]}),e.outputPricePerToken&&(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Precio salida:"})," $",e.outputPricePerToken.toString()," por token"]})]})]}),e.description&&(0,a.jsx)("p",{className:"text-gray-600 mt-3",children:e.description})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,a.jsx)(t.z,{variant:"outline",size:"sm",onClick:()=>{m(e),x(!0)},children:"Editar"}),(0,a.jsx)(t.z,{variant:"outline",size:"sm",onClick:()=>f(e.id,e.isActive),children:e.isActive?"Desactivar":"Activar"}),!e.isDefault&&e.isActive&&(0,a.jsx)(t.z,{variant:"outline",size:"sm",onClick:()=>g(e.id),children:"Hacer Default"}),(0,a.jsx)(t.z,{variant:"outline",size:"sm",onClick:()=>j(e.id,e.displayName),className:"text-red-600 hover:text-red-700 hover:border-red-300",children:"Eliminar"})]})]})},e.id))})})]})}},56948:function(e,r,s){"use strict";s.d(r,{Cd:function(){return d},X:function(){return c},bZ:function(){return l}});var a=s(15444),i=s(89300),t=s(2371),n=s(65522);let o=(0,t.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=i.forwardRef(({className:e,variant:r,...s},i)=>(0,a.jsx)("div",{ref:i,role:"alert",className:(0,n.cn)(o({variant:r}),e),...s}));l.displayName="Alert";let d=i.forwardRef(({className:e,...r},s)=>(0,a.jsx)("h5",{ref:s,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",e),...r}));d.displayName="AlertTitle";let c=i.forwardRef(({className:e,...r},s)=>(0,a.jsx)("div",{ref:s,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",e),...r}));c.displayName="AlertDescription"},61335:function(e,r,s){"use strict";s.d(r,{C:function(){return o}});var a=s(15444);s(89300);var i=s(2371),t=s(65522);let n=(0,i.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o({className:e,variant:r,...s}){return(0,a.jsx)("div",{className:(0,t.cn)(n({variant:r}),e),...s})}},2422:function(e,r,s){"use strict";s.d(r,{d:function(){return l},z:function(){return d}});var a=s(15444),i=s(89300),t=s(21030),n=s(2371),o=s(65522);let l=(0,n.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=i.forwardRef(({className:e,variant:r,size:s,asChild:i=!1,...n},d)=>{let c=i?t.g7:"button";return(0,a.jsx)(c,{className:(0,o.cn)(l({variant:r,size:s,className:e})),ref:d,...n})});d.displayName="Button"},99827:function(e,r,s){"use strict";s.d(r,{Ol:function(){return o},SZ:function(){return d},Zb:function(){return n},aY:function(){return c},eW:function(){return m},ll:function(){return l}});var a=s(15444),i=s(89300),t=s(65522);let n=i.forwardRef(({className:e,...r},s)=>(0,a.jsx)("div",{ref:s,className:(0,t.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...r}));n.displayName="Card";let o=i.forwardRef(({className:e,...r},s)=>(0,a.jsx)("div",{ref:s,className:(0,t.cn)("flex flex-col space-y-1.5 p-6",e),...r}));o.displayName="CardHeader";let l=i.forwardRef(({className:e,...r},s)=>(0,a.jsx)("h3",{ref:s,className:(0,t.cn)("text-2xl font-semibold leading-none tracking-tight",e),...r}));l.displayName="CardTitle";let d=i.forwardRef(({className:e,...r},s)=>(0,a.jsx)("p",{ref:s,className:(0,t.cn)("text-sm text-muted-foreground",e),...r}));d.displayName="CardDescription";let c=i.forwardRef(({className:e,...r},s)=>(0,a.jsx)("div",{ref:s,className:(0,t.cn)("p-6 pt-0",e),...r}));c.displayName="CardContent";let m=i.forwardRef(({className:e,...r},s)=>(0,a.jsx)("div",{ref:s,className:(0,t.cn)("flex items-center p-6 pt-0",e),...r}));m.displayName="CardFooter"},29530:function(e,r,s){"use strict";s.d(r,{$N:function(){return h},Be:function(){return f},Vq:function(){return l},cN:function(){return p},cZ:function(){return u},fK:function(){return x},hg:function(){return d}});var a=s(15444),i=s(89300),t=s(49095),n=s(33485),o=s(65522);let l=t.fC,d=t.xz,c=t.h_;t.x8;let m=i.forwardRef(({className:e,...r},s)=>(0,a.jsx)(t.aV,{ref:s,className:(0,o.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...r}));m.displayName=t.aV.displayName;let u=i.forwardRef(({className:e,children:r,...s},i)=>(0,a.jsxs)(c,{children:[(0,a.jsx)(m,{}),(0,a.jsxs)(t.VY,{ref:i,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...s,children:[r,(0,a.jsxs)(t.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(n.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));u.displayName=t.VY.displayName;let x=({className:e,...r})=>(0,a.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...r});x.displayName="DialogHeader";let p=({className:e,...r})=>(0,a.jsx)("div",{className:(0,o.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...r});p.displayName="DialogFooter";let h=i.forwardRef(({className:e,...r},s)=>(0,a.jsx)(t.Dx,{ref:s,className:(0,o.cn)("text-lg font-semibold leading-none tracking-tight",e),...r}));h.displayName=t.Dx.displayName;let f=i.forwardRef(({className:e,...r},s)=>(0,a.jsx)(t.dk,{ref:s,className:(0,o.cn)("text-sm text-muted-foreground",e),...r}));f.displayName=t.dk.displayName},74678:function(e,r,s){"use strict";s.d(r,{I:function(){return n}});var a=s(15444),i=s(89300),t=s(65522);let n=i.forwardRef(({className:e,type:r,...s},i)=>(0,a.jsx)("input",{type:r,className:(0,t.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:i,...s}));n.displayName="Input"},34635:function(e,r,s){"use strict";s.d(r,{Label:function(){return d}});var a=s(15444),i=s(89300),t=s(4100),n=s(2371),o=s(65522);let l=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=i.forwardRef(({className:e,...r},s)=>(0,a.jsx)(t.f,{ref:s,className:(0,o.cn)(l(),e),...r}));d.displayName=t.f.displayName},92232:function(e,r,s){"use strict";s.d(r,{Z:function(){return o}});var a=s(15444),i=s(89300),t=s(71033),n=s(65522);let o=i.forwardRef(({className:e,orientation:r="horizontal",decorative:s=!0,...i},o)=>(0,a.jsx)(t.f,{ref:o,decorative:s,orientation:r,className:(0,n.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",e),...i}));o.displayName=t.f.displayName},67012:function(e,r,s){"use strict";s.d(r,{g:function(){return n}});var a=s(15444),i=s(89300),t=s(65522);let n=i.forwardRef(({className:e,...r},s)=>(0,a.jsx)("textarea",{className:(0,t.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...r}));n.displayName="Textarea"},65522:function(e,r,s){"use strict";s.d(r,{cn:function(){return t}});var a=s(32191),i=s(23607);function t(...e){return(0,i.m6)((0,a.W)(e))}}},function(e){e.O(0,[6539,688,8077,7349,2386,7156,1744],function(){return e(e.s=10474)}),_N_E=e.O()}]);